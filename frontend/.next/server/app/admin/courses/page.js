(()=>{var e={};e.id=7630,e.ids=[7630],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},99824:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>i.a,__next_app__:()=>m,originalPathname:()=>u,pages:()=>c,routeModule:()=>x,tree:()=>d}),t(38490),t(5986),t(49328),t(20784),t(89204),t(35866);var a=t(23191),l=t(88716),r=t(37922),i=t.n(r),n=t(95231),o={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>n[e]);t.d(s,o);let d=["",{children:["admin",{children:["courses",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,38490)),"/Users/bibekaryal/Downloads/AnnapurnaHostipal-Nakhu/frontend/app/admin/courses/page.js"]}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,5986)),"/Users/bibekaryal/Downloads/AnnapurnaHostipal-Nakhu/frontend/app/admin/layout.js"]}]},{layout:[()=>Promise.resolve().then(t.bind(t,49328)),"/Users/bibekaryal/Downloads/AnnapurnaHostipal-Nakhu/frontend/app/layout.js"],error:[()=>Promise.resolve().then(t.bind(t,20784)),"/Users/bibekaryal/Downloads/AnnapurnaHostipal-Nakhu/frontend/app/error.js"],loading:[()=>Promise.resolve().then(t.bind(t,89204)),"/Users/bibekaryal/Downloads/AnnapurnaHostipal-Nakhu/frontend/app/loading.js"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,35866,23)),"next/dist/client/components/not-found-error"]}],c=["/Users/bibekaryal/Downloads/AnnapurnaHostipal-Nakhu/frontend/app/admin/courses/page.js"],u="/admin/courses/page",m={require:t,loadChunk:()=>Promise.resolve()},x=new a.AppPageRouteModule({definition:{kind:l.x.APP_PAGE,page:"/admin/courses/page",pathname:"/admin/courses",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},37728:(e,s,t)=>{Promise.resolve().then(t.bind(t,56235))},56235:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>g});var a=t(10326),l=t(17577),r=t(89420),i=t(6168),n=t(84625),o=t(1824),d=t(43404),c=t(55967),u=t(53133),m=t(14991),x=t(33265);t(24221);let p=(0,x.default)(async()=>{},{loadableGenerated:{modules:["app/admin/courses/page.js -> react-quill"]},ssr:!1}),h={title:"",slug:"",category:"",description:"",duration:"",certificationInfo:"",mode:"online",price:"",syllabus:[{topic:"Topic",items:[""]}],overview:"",detailedDescription:"",coverImage:"",galleryImages:[],promoVideos:[],videoUrl:"",isPublished:!1};function g(){let[e,s]=(0,l.useState)([]),[t,x]=(0,l.useState)([]),[g,b]=(0,l.useState)(!0),[v,y]=(0,l.useState)(!1),[j,f]=(0,l.useState)(h),[w,N]=(0,l.useState)(null),[k,C]=(0,l.useState)(!1),[P,_]=(0,l.useState)(!1),[A,D]=(0,l.useState)(null),I=(e="")=>e.toString().toLowerCase().trim().replace(/[^a-z0-9]+/g,"-").replace(/^-+|-+$/g,""),S=async()=>{b(!0);try{let[e,t]=await Promise.all([(0,r.R1)("/courses"),(0,r.R1)("/course-categories/active")]);s(e?.data||e||[]),x(t?.data||t||[])}catch(e){console.error("Courses admin load error:",e)}finally{b(!1)}},E=async e=>{D(e._id);try{let t=await (0,r.pE)(`/courses/${e._id}`,{isPublished:!e.isPublished}),a=t?.data||t;s(s=>s.map(s=>s._id===e._id?{...s,...a}:s))}catch(e){alert((0,i.i)(e,"Failed to update publish status"))}finally{D(null)}},U=e=>{N(e);let s=Array.from(new Set(Array.isArray(e.promoVideos)?e.promoVideos.map(e=>"string"==typeof e?e:e?.url).filter(Boolean):[]));f({...h,...e,syllabus:(e.syllabusNormalized||e.syllabus||[]).map(e=>({topic:e.topic||e.title||"",items:Array.isArray(e.items)?e.items:e.content?[e.content]:[]})),price:e.price??"",category:e.category?._id||e.category||"",overview:e.overview||e.description||"",detailedDescription:e.detailedDescription||e.description||"",galleryImages:e.galleryImages||[],promoVideos:s,videoUrl:e.videoUrl||s[0]||""}),_(!0),y(!0)},L=e=>{let{name:s,value:t,type:a,checked:l}=e.target,r="checkbox"===a?l:t;if("title"===s&&!P){f(e=>({...e,title:r,slug:I(r)}));return}"slug"===s&&_(!0),f(e=>({...e,[s]:r}))},V=(e,s)=>{f(t=>{let a=[...t.syllabus];return a[e].topic=s,{...t,syllabus:a}})},H=e=>{f(s=>({...s,syllabus:s.syllabus.filter((s,t)=>t!==e)}))},T=e=>{f(s=>{let t=[...s.syllabus],a=t[e].items||[];return t[e].items=[...a,""],{...s,syllabus:t}})},q=(e,s,t)=>{f(a=>{let l=[...a.syllabus],r=l[e].items||[];return r[s]=t,l[e].items=r,{...a,syllabus:l}})},B=(e,s)=>{f(t=>{let a=[...t.syllabus];return a[e].items=a[e].items.filter((e,t)=>t!==s),{...t,syllabus:a}})},R=async()=>{if(!j.title.trim()){alert("Title is required");return}let e=j.overview.replace(/<[^>]+>/g," ").trim();if((e?e.split(/\s+/).filter(Boolean).length:0)>50){alert("Overview should be 50 words or fewer.");return}C(!0);try{let e=(j.syllabus||[]).filter(e=>e.topic&&(e.items||[]).some(e=>e&&e.trim()));if(!e.length){alert("Add at least one topic with a sub-topic in the syllabus."),C(!1);return}let s=[...j.promoVideos||[],j.videoUrl].map(e=>"string"==typeof e?e:e?.url).filter(Boolean),t=Array.from(new Set(s)),a={title:j.title,slug:j.slug,category:j.category||void 0,overview:j.overview,detailedDescription:j.detailedDescription,description:j.detailedDescription||j.overview,duration:j.duration,certificationInfo:j.certificationInfo,mode:j.mode,price:""===j.price?0:Number(j.price),syllabus:e.map(e=>({topic:e.topic,items:(e.items||[]).filter(e=>e&&e.trim())})),coverImage:j.coverImage,galleryImages:j.galleryImages,promoVideos:t,videoUrl:t[0]||"",isPublished:j.isPublished};w?await (0,r.pE)(`/courses/${w._id}`,a):await (0,r.sg)("/courses",a),y(!1),N(null),f(h),S()}catch(e){alert((0,i.i)(e,"Failed to save course"))}finally{C(!1)}},Z=async e=>{if(confirm("Delete this course?"))try{await (0,r.QW)(`/courses/${e}`),S()}catch(e){alert((0,i.i)(e,"Delete failed"))}};return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[a.jsx("h1",{className:"text-2xl font-semibold text-white",children:"Courses"}),a.jsx("p",{className:"text-sm text-slate-400",children:"Yoga Teacher Training, Online Courses, Sound Healing."})]}),(0,a.jsxs)("button",{onClick:()=>{f({...h,category:t[0]?._id||""}),_(!1),N(null),y(!0)},className:"inline-flex items-center gap-2 bg-teal-600 hover:bg-teal-500 text-white px-4 py-2 rounded-lg transition",children:[a.jsx(n.Z,{className:"h-5 w-5"}),"Add Course"]})]}),g?a.jsx("p",{className:"text-slate-400 text-sm",children:"Loading..."}):0===e.length?a.jsx("div",{className:"text-slate-400 text-sm bg-slate-900 border border-slate-800 rounded-lg p-6",children:"No courses yet."}):a.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-3 gap-4",children:e.map(e=>(0,a.jsxs)("div",{className:"rounded-xl border border-white/10 bg-[#0f131a] p-4 space-y-3 shadow-sm",children:[a.jsx("div",{className:"rounded-lg overflow-hidden bg-slate-800 h-32 border border-slate-800",children:e.coverImage?a.jsx("img",{src:e.coverImage,alt:e.title,className:"w-full h-full object-cover"}):a.jsx("div",{className:"w-full h-full flex items-center justify-center text-slate-500 text-xs",children:"No image"})}),(0,a.jsxs)("div",{className:"flex items-start justify-between gap-2",children:[(0,a.jsxs)("div",{className:"space-y-1",children:[a.jsx("p",{className:"text-white font-semibold line-clamp-2",children:e.title}),a.jsx("p",{className:"text-xs text-slate-400",children:e.category})]}),(0,a.jsxs)("div",{className:"flex flex-col items-end gap-1",children:[a.jsx("span",{className:`px-3 py-1 rounded-full text-xs ${e.isPublished?"bg-green-900/60 text-green-300":"bg-slate-800 text-slate-300"}`,children:e.isPublished?"Published":"Draft"}),a.jsx(m.W,{status:e.isPublished?"published":"draft",onToggle:()=>E(e),disabled:A===e._id})]})]}),a.jsx("p",{className:"text-sm text-slate-300 line-clamp-2",children:e.description}),(0,a.jsxs)("div",{className:"flex gap-2 pt-2",children:[(0,a.jsxs)("button",{onClick:()=>U(e),className:"inline-flex items-center gap-1 px-3 py-1.5 rounded-lg bg-slate-800 hover:bg-slate-700 text-slate-100 text-sm",children:[a.jsx(o.Z,{className:"h-4 w-4"}),"Edit"]}),(0,a.jsxs)("button",{onClick:()=>Z(e._id),className:"inline-flex items-center gap-1 px-3 py-1.5 rounded-lg bg-red-900/60 hover:bg-red-800 text-red-100 text-sm",children:[a.jsx(d.Z,{className:"h-4 w-4"}),"Delete"]})]})]},e._id))}),v&&a.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-center justify-center px-4 py-8",children:(0,a.jsxs)("div",{className:"w-full max-w-5xl max-h-[90vh] bg-[#0f131a] border border-white/10 rounded-2xl shadow-2xl overflow-hidden flex flex-col",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between px-6 py-4 border-b border-slate-800",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("h2",{className:"text-xl font-semibold text-white",children:[w?"Edit":"Add"," Course"]}),a.jsx("p",{className:"text-sm text-slate-400",children:"Courses are separate from health packages and retreats."})]}),a.jsx("button",{onClick:()=>y(!1),className:"text-slate-400 hover:text-white text-xl leading-none",children:"\xd7"})]}),(0,a.jsxs)("div",{className:"flex-1 overflow-y-auto px-6 py-4 space-y-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-sm text-slate-300",children:"Title"}),a.jsx("input",{name:"title",value:j.title,onChange:L,className:"w-full bg-slate-900 border border-slate-700 rounded-lg px-4 py-3 text-white"})]}),(0,a.jsxs)("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-sm text-slate-300",children:"Slug"}),a.jsx("input",{name:"slug",value:j.slug,onChange:L,className:"w-full bg-slate-900 border border-slate-700 rounded-lg px-4 py-3 text-white"})]}),(0,a.jsxs)("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-sm text-slate-300",children:"Category"}),(0,a.jsxs)("select",{name:"category",value:j.category,onChange:L,className:"w-full bg-slate-900 border border-slate-700 rounded-lg px-4 py-3 text-white",children:[a.jsx("option",{value:"",children:"Select category"}),t.map(e=>a.jsx("option",{value:e._id,children:e.name},e._id))]}),0===t.length&&a.jsx("p",{className:"text-xs text-teal-200",children:"Create categories first in the Course Categories tab."})]}),(0,a.jsxs)("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-sm text-slate-300",children:"Mode"}),(0,a.jsxs)("select",{name:"mode",value:j.mode,onChange:L,className:"w-full bg-slate-900 border border-slate-700 rounded-lg px-4 py-3 text-white",children:[a.jsx("option",{value:"online",children:"Online"}),a.jsx("option",{value:"residential",children:"Residential"})]})]}),(0,a.jsxs)("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-sm text-slate-300",children:"Duration"}),a.jsx("input",{name:"duration",value:j.duration,onChange:L,className:"w-full bg-slate-900 border border-slate-700 rounded-lg px-4 py-3 text-white"})]}),(0,a.jsxs)("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-sm text-slate-300",children:"Price (USD)"}),a.jsx("input",{name:"price",type:"number",value:j.price,onChange:L,className:"w-full bg-slate-900 border border-slate-700 rounded-lg px-4 py-3 text-white"})]})]}),(0,a.jsxs)("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-sm text-slate-300",children:"Cover image"}),a.jsx(u.Z,{accept:"image/*",maxItems:1,value:j.coverImage?[j.coverImage]:[],onChange:e=>f(s=>({...s,coverImage:e[0]||""}))})]}),(0,a.jsxs)("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-sm text-slate-300",children:"Overview (max ~300 words)"}),a.jsx("div",{className:"bg-slate-900 border border-slate-700 rounded-lg",children:a.jsx(p,{theme:"snow",value:j.overview,onChange:e=>f(s=>e.replace(/<[^>]+>/g," ").trim().split(/\s+/).filter(Boolean).length>50?s:{...s,overview:e})})}),(0,a.jsxs)("p",{className:"text-xs text-slate-400",children:[j.overview.replace(/<[^>]+>/g,"").trim().split(/\s+/).filter(Boolean).length," / 50 words"]})]}),(0,a.jsxs)("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-sm text-slate-300",children:"Detailed description"}),a.jsx("div",{className:"bg-slate-900 border border-slate-700 rounded-lg",children:a.jsx(p,{theme:"snow",value:j.detailedDescription,onChange:e=>f(s=>({...s,detailedDescription:e}))})}),(0,a.jsxs)("p",{className:"text-xs text-slate-400",children:[j.detailedDescription.replace(/<[^>]+>/g,"").trim().split(/\s+/).filter(Boolean).length," / 50 words max"]})]}),(0,a.jsxs)("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-sm text-slate-300",children:"Certification info"}),a.jsx("input",{name:"certificationInfo",value:j.certificationInfo,onChange:L,className:"w-full bg-slate-900 border border-slate-700 rounded-lg px-4 py-3 text-white"})]}),a.jsx(c.Z,{title:"Media",images:j.galleryImages,setImages:e=>f(s=>({...s,galleryImages:e})),videos:j.promoVideos,setVideos:e=>f(s=>({...s,promoVideos:e})),maxImages:10,maxVideos:3,showVideoUpload:!1}),(0,a.jsxs)("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-sm text-slate-300",children:"YouTube link (optional)"}),a.jsx("input",{type:"text",value:j.videoUrl,onChange:e=>f(s=>({...s,videoUrl:e.target.value})),placeholder:"Paste a YouTube URL",className:"w-full bg-slate-900 border border-slate-700 rounded-lg px-4 py-3 text-white"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[a.jsx("label",{className:"text-sm text-slate-300",children:"Syllabus"}),a.jsx("button",{onClick:()=>{f(e=>({...e,syllabus:[...e.syllabus,{topic:"",items:[""]}]}))},type:"button",className:"text-xs text-teal-300",children:"+ Add topic"})]}),a.jsx("div",{className:"space-y-3",children:j.syllabus.map((e,s)=>(0,a.jsxs)("div",{className:"border border-slate-800 rounded-lg p-3 space-y-2 bg-slate-900",children:[(0,a.jsxs)("div",{className:"flex items-start gap-2",children:[a.jsx("input",{value:e.topic,onChange:e=>V(s,e.target.value),className:"flex-1 bg-slate-800 border border-slate-700 rounded-lg px-3 py-2 text-white",placeholder:"Topic title"}),j.syllabus.length>1&&a.jsx("button",{onClick:()=>H(s),type:"button",className:"px-2 py-1 rounded-lg bg-red-900/60 text-red-100 text-xs",children:"Remove"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[a.jsx("p",{className:"text-xs text-slate-300",children:"Sub-topics"}),a.jsx("button",{type:"button",onClick:()=>T(s),className:"text-xs text-teal-300",children:"+ Add sub-topic"})]}),(e.items||[]).map((t,l)=>(0,a.jsxs)("div",{className:"flex gap-2",children:[a.jsx("input",{value:t,onChange:e=>q(s,l,e.target.value),className:"flex-1 bg-slate-800 border border-slate-700 rounded-lg px-3 py-2 text-white",placeholder:"Sub-topic"}),e.items.length>1&&a.jsx("button",{type:"button",onClick:()=>B(s,l),className:"px-2 py-2 rounded-lg bg-red-900/60 text-red-100 text-xs",children:"\xd7"})]},l))]})]},s))})]}),(0,a.jsxs)("div",{className:"flex gap-2 items-center",children:[a.jsx("input",{type:"checkbox",name:"isPublished",checked:j.isPublished,onChange:L}),a.jsx("label",{className:"text-sm text-slate-300",children:"Published"})]})]}),(0,a.jsxs)("div",{className:"px-6 py-4 border-t border-slate-800 flex justify-end gap-3",children:[a.jsx("button",{onClick:()=>y(!1),className:"px-4 py-2 rounded-lg bg-slate-800 text-white",children:"Cancel"}),a.jsx("button",{onClick:R,disabled:k,className:"px-4 py-2 rounded-lg bg-teal-600 text-white disabled:opacity-60",children:k?"Saving...":w?"Save changes":"Create Course"})]})]})})]})}},38490:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>a});let a=(0,t(68570).createProxy)(String.raw`/Users/bibekaryal/Downloads/AnnapurnaHostipal-Nakhu/frontend/app/admin/courses/page.js#default`)},1824:(e,s,t)=>{"use strict";t.d(s,{Z:()=>l});var a=t(17577);let l=a.forwardRef(function({title:e,titleId:s,...t},l){return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:l,"aria-labelledby":s},t),e?a.createElement("title",{id:s},e):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10"}))})},84625:(e,s,t)=>{"use strict";t.d(s,{Z:()=>l});var a=t(17577);let l=a.forwardRef(function({title:e,titleId:s,...t},l){return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:l,"aria-labelledby":s},t),e?a.createElement("title",{id:s},e):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4.5v15m7.5-7.5h-15"}))})},43404:(e,s,t)=>{"use strict";t.d(s,{Z:()=>l});var a=t(17577);let l=a.forwardRef(function({title:e,titleId:s,...t},l){return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:l,"aria-labelledby":s},t),e?a.createElement("title",{id:s},e):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"}))})}};var s=require("../../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),a=s.X(0,[8948,829,9143,5092,713],()=>t(99824));module.exports=a})();