"use strict";exports.id=7082,exports.ids=[7082],exports.modules={17082:(e,s,t)=>{t.d(s,{Z:()=>d});var a=t(10326),l=t(17577),r=t(89420);let o={name:"",email:"",phone:"",preferredStartDate:"",people:1,notes:""},n={none:"No accommodation",location:"Choose by location",star:"Choose by hotel rating",locationAndStar:"Choose by location & rating"};function d({pkg:e,onClose:s}){let[t,d]=(0,l.useState)(o),[i,c]=(0,l.useState)(!1),[x,m]=(0,l.useState)(!1),[p,f]=(0,l.useState)(null),[u,b]=(0,l.useState)([]),[h,g]=(0,l.useState)("none"),[N,j]=(0,l.useState)(""),[y,v]=(0,l.useState)(""),[w,D]=(0,l.useState)(null),k=(0,l.useMemo)(()=>e?.duration||e?.durationDays||1,[e?.duration,e?.durationDays]),S=e?.price&&Number(e.price)>0?Number(e.price):null,C=S?S*(Number(t.people)||1):null,F=(0,l.useMemo)(()=>Array.from(new Set((u||[]).map(e=>e.location).filter(Boolean))),[u]),$=(0,l.useMemo)(()=>Array.from(new Set((u||[]).map(e=>e.starRating).filter(Boolean))).sort(),[u]),P=(0,l.useMemo)(()=>"location"===h?u.filter(e=>!N||e.location===N):"star"===h?u.filter(e=>!y||Number(e.starRating)===Number(y)):"locationAndStar"===h?u.filter(e=>(!N||e.location===N)&&(!y||Number(e.starRating)===Number(y))):[],[h,u,N,y]),A="none"===h?null:P.find(e=>e._id===w)||P[0],R=A&&Number(A.pricePerNight)||0,_=R*(k||1),q=null!==C?C+_:null,B=S&&S>0?`$${S}`:"Contact for pricing",M=e=>{let{name:s,value:t}=e.target;if("people"===s){let e=Math.max(1,Number(t)||1);d(t=>({...t,[s]:e}));return}d(e=>({...e,[s]:t}))},I=()=>{m(!1),f(null),d(o),g("none"),j(""),v(""),D(null),s?.()},H=async s=>{if(s.preventDefault(),!t.name||!t.email||!t.phone||!t.people||1>Number(t.people)){alert("Please fill name, email, phone, and at least 1 person.");return}c(!0);try{let s=await (0,r.sg)("/package-bookings",{packageId:e._id,packageName:e.name,name:t.name,email:t.email,phone:t.phone,preferredStartDate:t.preferredStartDate,people:Number(t.people)||1,notes:t.notes,accommodationMode:h,selectedLocation:N,selectedStarRating:y,partnerHotelId:A?._id,accommodationPricePerNight:R,accommodationNights:k||1,accommodationTotalCost:_,totalAmount:q||void 0});f(s?.data?._id||s?._id||null),m(!0)}catch(e){alert(e?.message||"Failed to submit booking.")}c(!1)},z=async()=>{if(p)try{let e=await (0,r.sg)("/payments/stripe/checkout",{bookingId:p,type:"package"});e?.url&&(window.location.href=e.url)}catch(e){alert(e?.message||"Unable to start Stripe checkout.")}},E=(0,a.jsxs)("div",{className:"space-y-2 text-sm text-[#10231a]",children:[(0,a.jsxs)("div",{className:"rounded-lg bg-[#fff7ed] border border-[#f2d5b1] px-3 py-2",children:[a.jsx("p",{className:"font-semibold text-[#c2410c]",children:"Important"}),a.jsx("p",{children:"Extra charges apply for any activities or services not listed in the program description."})]}),(0,a.jsxs)("div",{className:"rounded-lg bg-[#fef2f2] border border-[#fecdd3] px-3 py-2",children:[a.jsx("p",{className:"font-semibold text-[#be123c]",children:"Refund Policy"}),a.jsx("p",{children:"After payment, booking cancellations will incur a 10% deduction of the total booking cost."})]})]});return e?a.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-start justify-center px-4 py-10",onClick:I,children:(0,a.jsxs)("div",{className:"w-full max-w-3xl max-h-[90vh] bg-white rounded-2xl shadow-2xl border border-[#dfe8e2] p-6 md:p-8 space-y-6 overflow-y-auto",onClick:e=>e.stopPropagation(),children:[(0,a.jsxs)("div",{className:"flex items-start justify-between",children:[(0,a.jsxs)("div",{children:[a.jsx("p",{className:"text-xs uppercase tracking-[0.2em] text-[#2F8D59] font-semibold",children:"Package Booking"}),a.jsx("h3",{className:"text-xl font-semibold text-[#10231a]",children:e?.name}),(0,a.jsxs)("p",{className:"text-sm text-[#4c5f68]",children:[e?.duration?`${e.duration} days`:""," \xb7 ",B]})]}),a.jsx("button",{onClick:I,className:"text-sm text-[#2F8D59] font-semibold","aria-label":"Close booking",children:"✕"})]}),x?(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3 text-sm",children:[(0,a.jsxs)("div",{className:"rounded-xl border border-[#dfe8e2] bg-[#f5f8f4] px-4 py-3",children:[a.jsx("p",{className:"text-[#4c5f68]",children:"Price per person"}),a.jsx("p",{className:"font-semibold text-[#10231a]",children:S?`$${S}`:"—"})]}),(0,a.jsxs)("div",{className:"rounded-xl border border-[#dfe8e2] bg-[#f5f8f4] px-4 py-3",children:[a.jsx("p",{className:"text-[#4c5f68]",children:"Accommodation"}),a.jsx("p",{className:"font-semibold text-[#10231a]",children:"none"===h?"No accommodation":`$${R} / night`})]}),(0,a.jsxs)("div",{className:"rounded-xl border-2 border-[#2F8D59] bg-[#e6f2ea] px-4 py-3",children:[a.jsx("p",{className:"text-[#2F8D59] font-semibold",children:"Total amount"}),a.jsx("p",{className:"text-lg font-bold text-[#10231a]",children:q?`$${q}`:"—"})]})]}),"none"!==h&&A&&(0,a.jsxs)("div",{className:"text-sm text-[#10231a] bg-[#f5f8f4] border border-[#dfe8e2] rounded-xl px-4 py-3",children:[a.jsx("p",{className:"font-semibold text-[#2F8D59]",children:"Partner hotel"}),(0,a.jsxs)("p",{children:[A.location," ",A.starRating?`\xb7 ${A.starRating}★`:""," — $",A.pricePerNight,"/night \xd7 ",k," night",1===k?"":"s"," = $",_]})]}),E,(0,a.jsxs)("div",{className:"space-y-3",children:[a.jsx("p",{className:"text-sm font-semibold text-[#10231a]",children:"Choose how you want to pay"}),(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3",children:[a.jsx("button",{onClick:z,className:"flex-1 inline-flex justify-center items-center rounded-full bg-[#2F8D59] text-white text-sm font-semibold px-4 py-3 hover:bg-[#27784c] transition",children:"Pay now with Stripe"}),a.jsx("button",{onClick:()=>{alert("Booking placed successfully. Pay later to confirm."),I()},className:"flex-1 inline-flex justify-center items-center rounded-full border border-[#dfe8e2] text-[#10231a] text-sm font-semibold px-4 py-3 hover:bg-[#f5f8f4] transition",children:"Pay later"})]})]})]}):(0,a.jsxs)("form",{className:"space-y-4",onSubmit:H,children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-sm text-[#10231a] font-semibold",children:"Full Name"}),a.jsx("input",{name:"name",required:!0,value:t.name,onChange:M,className:"w-full rounded-xl border border-[#dfe8e2] px-4 py-3 text-sm text-[#10231a] focus:outline-none focus:border-[#2F8D59] focus:ring-2 focus:ring-[#cfe8d6]"})]}),(0,a.jsxs)("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-sm text-[#10231a] font-semibold",children:"Email"}),a.jsx("input",{name:"email",type:"email",required:!0,value:t.email,onChange:M,className:"w-full rounded-xl border border-[#dfe8e2] px-4 py-3 text-sm text-[#10231a] focus:outline-none focus:border-[#2F8D59] focus:ring-2 focus:ring-[#cfe8e2]"})]}),(0,a.jsxs)("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-sm text-[#10231a] font-semibold",children:"Phone Number"}),a.jsx("input",{name:"phone",required:!0,value:t.phone,onChange:M,className:"w-full rounded-xl border border-[#dfe8e2] px-4 py-3 text-sm text-[#10231a] focus:outline-none focus:border-[#2F8D59] focus:ring-2 focus:ring-[#cfe8d6]"})]}),(0,a.jsxs)("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-sm text-[#10231a] font-semibold",children:"Selected Package"}),a.jsx("input",{value:e?.name||"Health Package",readOnly:!0,className:"w-full rounded-xl border border-[#dfe8e2] px-4 py-3 text-sm text-[#10231a] bg-[#f5f8f4]"})]}),(0,a.jsxs)("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-sm text-[#10231a] font-semibold",children:"Preferred Start Date"}),a.jsx("input",{type:"date",name:"preferredStartDate",value:t.preferredStartDate,onChange:M,className:"w-full rounded-xl border border-[#dfe8e2] px-4 py-3 text-sm text-[#10231a] focus:outline-none focus:border-[#2F8D59] focus:ring-2 focus:ring-[#cfe8d6]"})]}),(0,a.jsxs)("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-sm text-[#10231a] font-semibold",children:"Number of persons *"}),a.jsx("input",{type:"number",min:1,name:"people",value:t.people,onChange:M,required:!0,className:"w-full rounded-xl border border-[#dfe8e2] px-4 py-3 text-sm text-[#10231a] focus:outline-none focus:border-[#2F8D59] focus:ring-2 focus:ring-[#cfe8d6]"})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[a.jsx("label",{className:"text-sm text-[#10231a] font-semibold",children:"Partner hotel accommodation"}),(0,a.jsxs)("div",{className:"space-y-3 border border-[#dfe8e2] rounded-xl p-4 bg-[#f9fcf8]",children:[a.jsx("div",{className:"flex flex-wrap gap-2",children:["none","location","star","locationAndStar"].map(e=>a.jsx("button",{type:"button",onClick:()=>g(e),className:`px-3 py-2 rounded-full text-sm border ${h===e?"bg-[#2F8D59] text-white border-[#2F8D59]":"bg-white text-[#10231a] border-[#dfe8e2]"}`,children:n[e]},e))}),"none"!==h&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[("location"===h||"locationAndStar"===h)&&(0,a.jsxs)("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-sm font-semibold text-[#10231a]",children:"Location"}),(0,a.jsxs)("select",{value:N,onChange:e=>{j(e.target.value),D(null)},className:"w-full rounded-xl border border-[#dfe8e2] px-3 py-2 text-sm",children:[a.jsx("option",{value:"",children:"Choose location"}),F.map(e=>a.jsx("option",{value:e,children:e},e))]})]}),("star"===h||"locationAndStar"===h)&&(0,a.jsxs)("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-sm font-semibold text-[#10231a]",children:"Hotel quality"}),(0,a.jsxs)("select",{value:y,onChange:e=>{v(e.target.value),D(null)},className:"w-full rounded-xl border border-[#dfe8e2] px-3 py-2 text-sm",children:[a.jsx("option",{value:"",children:"Choose rating"}),$.map(e=>(0,a.jsxs)("option",{value:e,children:[e," ★"]},e))]})]})]}),0===P.length?a.jsx("div",{className:"text-sm text-[#4c5f68] bg-white border border-[#dfe8e2] rounded-lg px-3 py-2",children:"No partner hotels match this selection yet."}):a.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:P.map(e=>{let s=w===e._id;return a.jsx("button",{type:"button",onClick:()=>D(e._id),className:`w-full text-left border rounded-lg px-4 py-3 transition ${s?"border-[#2F8D59] bg-[#e6f2ea]":"border-[#dfe8e2] bg-white"}`,children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("p",{className:"font-semibold text-[#10231a]",children:[e.location," ",e.starRating?`\xb7 ${e.starRating}★`:""]}),(0,a.jsxs)("p",{className:"text-sm text-[#4c5f68]",children:["USD ",e.pricePerNight," / night"]})]}),a.jsx("span",{className:`h-4 w-4 rounded-full border ${s?"border-[#2F8D59] bg-[#2F8D59]":"border-[#dfe8e2]"}`,"aria-hidden":!0})]})},e._id)})})]})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3 text-sm",children:[(0,a.jsxs)("div",{className:"rounded-xl border border-[#dfe8e2] bg-[#f5f8f4] px-4 py-3",children:[a.jsx("p",{className:"text-[#4c5f68]",children:"Price per person"}),a.jsx("p",{className:"font-semibold text-[#10231a]",children:S?`$${S}`:"—"})]}),(0,a.jsxs)("div",{className:"rounded-xl border border-[#dfe8e2] bg-[#f5f8f4] px-4 py-3",children:[a.jsx("p",{className:"text-[#4c5f68]",children:"Duration"}),(0,a.jsxs)("p",{className:"font-semibold text-[#10231a]",children:[k," night",1===k?"":"s"]})]}),(0,a.jsxs)("div",{className:"rounded-xl border-2 border-[#2F8D59] bg-[#e6f2ea] px-4 py-3",children:[a.jsx("p",{className:"text-[#2F8D59] font-semibold",children:"Total amount"}),a.jsx("p",{className:"text-lg font-bold text-[#10231a]",children:q?`$${q}`:"—"})]})]}),(0,a.jsxs)("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-sm text-[#10231a] font-semibold",children:"Additional Notes"}),a.jsx("textarea",{name:"notes",rows:3,value:t.notes,onChange:M,className:"w-full rounded-xl border border-[#dfe8e2] px-4 py-3 text-sm text-[#10231a] focus:outline-none focus:border-[#2F8D59] focus:ring-2 focus:ring-[#cfe8d6] resize-none",placeholder:"Share any preferences or health goals"})]}),E,(0,a.jsxs)("div",{className:"flex justify-end gap-2 pt-2",children:[a.jsx("button",{type:"button",onClick:I,className:"px-4 py-2 rounded-full border border-[#dfe8e2] text-[#10231a] hover:bg-[#f5f8f4] transition",children:"Cancel"}),a.jsx("button",{type:"submit",disabled:i,className:"px-5 py-2 rounded-full bg-[#2F8D59] text-white text-sm font-semibold hover:bg-[#27784c] transition disabled:opacity-60",children:i?"Sending...":"Book Package"})]})]})]})}):null}}};