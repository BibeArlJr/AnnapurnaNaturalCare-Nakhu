(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7211],{91176:function(e,t,a){Promise.resolve().then(a.bind(a,39203))},39203:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return m}});var l=a(57437),s=a(2265),r=a(99376),n=a(74942),i=a(87091),o=a(31260),d=a(30166),c=a(32617);a(98527);let u=(0,d.default)(()=>Promise.all([a.e(3070),a.e(1804)]).then(a.t.bind(a,5600,23)),{loadableGenerated:{webpack:()=>[5600]},ssr:!1}),x="w-full bg-slate-800 border border-slate-700 rounded-xl px-4 py-3 text-white placeholder-slate-500 focus:outline-none focus:ring-2 focus:ring-teal-500";function m(e){var t;let{params:a}=e,d=(0,r.useRouter)(),m=(0,s.useRef)(null);(0,s.useRef)(null);let[g,b]=(0,s.useState)([]),[v,j]=(0,s.useState)(!0),[y,N]=(0,s.useState)(""),[w,C]=(0,s.useState)(!1),[P,S]=(0,s.useState)(""),[D,R]=(0,s.useState)(""),[k,U]=(0,s.useState)(""),[_,I]=(0,s.useState)(""),[O,E]=(0,s.useState)(""),[M,Q]=(0,s.useState)(""),[T,F]=(0,s.useState)({name:"",email:"",phone:"",departmentId:"",experience:"",degree:"",description:"",photo:"",galleryImages:[],videoUrl:"",medicalQualifications:[]});async function A(){j(!0),N("");try{var e,t;let l=await (0,c.R1)("/doctors/".concat(a.id,"?includeDrafts=true")),s=(null==l?void 0:l.data)||l||{};F({name:s.name||"",email:s.email||"",phone:s.phone||"",departmentId:(null===(e=s.departmentId)||void 0===e?void 0:e._id)||s.departmentId||"",experience:null!==(t=s.experienceYears)&&void 0!==t?t:"",degree:s.degree||"",description:s.description||s.bio||"",photo:s.photo||"",galleryImages:s.galleryImages||[],videoUrl:s.videoUrl||"",medicalQualifications:s.medicalQualifications||[]}),S(s.photo||""),Q(s.videoUrl||""),await B()}catch(e){N("Doctor not found")}finally{j(!1)}}async function B(){try{let e=await (0,c.R1)("/departments?includeDrafts=true"),t=(null==e?void 0:e.data)||e||[];b(t)}catch(e){console.error("Department fetch error:",e)}}function L(e){let{name:t,value:a}=e.target;F(e=>({...e,[t]:a}))}function G(e){if(!e)return;let t=new FileReader;t.onloadend=()=>{U(t.result.toString()),S(t.result.toString()),R(e.name)},t.readAsDataURL(e)}function q(e,t,a){F(l=>{let s=[...l.medicalQualifications||[]];return s[e]={...s[e],[t]:a},{...l,medicalQualifications:s}})}async function J(e){if(e.preventDefault(),T.name&&T.departmentId){C(!0);try{var t;let e=Array.isArray(T.galleryImages)?T.galleryImages:[],l=e.filter(e=>e&&!e.startsWith("data:")),s=e.filter(e=>e&&e.startsWith("data:")),r={...T,experience:T.experience,degree:T.degree,imageData:k||void 0,bio:T.description,galleryImages:l,galleryImageData:s,videoUrl:null===(t=T.videoUrl)||void 0===t?void 0:t.trim(),videoData:O||void 0,medicalQualifications:(T.medicalQualifications||[]).filter(e=>e&&e.degree)};await (0,c.pE)("/doctors/".concat(a.id),r),d.push("/admin/doctors")}catch(e){N(e.message||"Failed to update doctor")}finally{C(!1)}}}return(0,s.useEffect)(()=>{A()},[null==a?void 0:a.id]),(0,l.jsx)("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50 px-4",children:(0,l.jsxs)("div",{className:"relative w-full max-w-4xl max-h-[90vh] bg-[#0f131a] border border-white/10 rounded-2xl shadow-2xl flex flex-col overflow-hidden",children:[(0,l.jsx)("button",{onClick:()=>d.push("/admin/doctors"),className:"absolute top-4 right-4 text-gray-300 hover:text-white bg-slate-700/40 hover:bg-slate-700 rounded-full p-2 transition",children:"âœ•"}),(0,l.jsxs)("div",{className:"px-6 pt-6 pb-3 border-b border-slate-800",children:[(0,l.jsx)("h2",{className:"text-xl font-semibold text-white",children:"Edit Doctor"}),(0,l.jsx)("p",{className:"text-sm text-slate-400",children:"Update doctor profile, department, and photo."})]}),(0,l.jsxs)("form",{onSubmit:J,className:"flex-1 overflow-y-auto px-6 pb-6 pt-4 space-y-6",children:[y&&(0,l.jsx)("div",{className:"rounded-lg border border-rose-500/40 bg-rose-900/20 text-rose-200 px-4 py-3 text-sm",children:y}),v?(0,l.jsxs)("div",{className:"animate-pulse space-y-4",children:[(0,l.jsx)("div",{className:"h-10 bg-slate-800 rounded-lg"}),(0,l.jsx)("div",{className:"h-24 bg-slate-800 rounded-lg"}),(0,l.jsx)("div",{className:"h-32 bg-slate-800 rounded-lg"})]}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsx)("p",{className:"text-xs uppercase tracking-wide text-slate-500",children:"Info"}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,l.jsxs)("div",{className:"space-y-1",children:[(0,l.jsx)("label",{className:"text-sm text-slate-300",children:"Name"}),(0,l.jsx)("input",{name:"name",required:!0,value:T.name,onChange:L,className:x,placeholder:"Dr. Jane Doe"})]}),(0,l.jsxs)("div",{className:"space-y-1",children:[(0,l.jsx)("label",{className:"text-sm text-slate-300",children:"Department"}),(0,l.jsx)(n.Ri,{value:T.departmentId,onChange:e=>F(t=>({...t,departmentId:e})),children:(0,l.jsxs)("div",{className:"relative mt-1",children:[(0,l.jsxs)(n.Ri.Button,{className:"relative w-full cursor-pointer rounded-xl bg-slate-800 border border-slate-700 px-4 py-3 pr-10 text-left text-white focus:outline-none focus:ring-2 focus:ring-teal-500",children:[(0,l.jsx)("span",{children:(null===(t=g.find(e=>e._id===T.departmentId))||void 0===t?void 0:t.name)||"Select department"}),(0,l.jsx)("span",{className:"absolute inset-y-0 right-0 flex items-center pr-3",children:(0,l.jsx)(i.Z,{className:"h-5 w-5 text-gray-400"})})]}),(0,l.jsxs)(n.Ri.Options,{className:"absolute mt-2 max-h-60 w-full overflow-auto rounded-xl bg-slate-900 shadow-xl border border-slate-700 text-white focus:outline-none z-30",children:[g.map(e=>(0,l.jsx)(n.Ri.Option,{value:e._id,className:e=>{let{active:t}=e;return"cursor-pointer select-none px-4 py-2 ".concat(t?"bg-teal-700/70 text-white":"text-gray-200")},children:t=>{let{selected:a}=t;return(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsx)("span",{className:a?"font-semibold":"",children:e.name}),a&&(0,l.jsx)(o.Z,{className:"h-5 w-5 text-teal-300"})]})}},e._id)),0===g.length&&(0,l.jsx)("div",{className:"px-4 py-2 text-sm text-slate-400",children:"No departments"})]})]})})]}),(0,l.jsxs)("div",{className:"space-y-1",children:[(0,l.jsx)("label",{className:"text-sm text-slate-300",children:"Email"}),(0,l.jsx)("input",{name:"email",type:"email",value:T.email,onChange:L,className:x,placeholder:"doctor@example.com"})]}),(0,l.jsxs)("div",{className:"space-y-1",children:[(0,l.jsx)("label",{className:"text-sm text-slate-300",children:"Phone"}),(0,l.jsx)("input",{name:"phone",value:T.phone,onChange:L,className:x,placeholder:"+977-98xxxxxxx"})]}),(0,l.jsxs)("div",{className:"space-y-1",children:[(0,l.jsx)("label",{className:"text-sm text-slate-300",children:"Experience (years)"}),(0,l.jsx)("input",{name:"experience",value:T.experience,onChange:L,className:x,placeholder:"10"})]}),(0,l.jsxs)("div",{className:"space-y-1",children:[(0,l.jsx)("label",{className:"text-sm text-slate-300",children:"Degree"}),(0,l.jsx)("input",{name:"degree",value:T.degree,onChange:L,className:x,placeholder:"e.g., MD, MBBS"})]})]}),(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)("label",{className:"text-sm text-slate-300",children:"About / Description"}),(0,l.jsx)(u,{theme:"snow",value:T.description,onChange:e=>F(t=>({...t,description:e})),placeholder:"Add rich details about the doctor",modules:{toolbar:[[{header:[1,2,3,!1]}],["bold","italic","underline"],[{list:"ordered"},{list:"bullet"}],["link"],["clean"]]}})]})]}),(0,l.jsxs)("div",{className:"space-y-3",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsx)("p",{className:"text-sm text-slate-300",children:"Medical Qualifications"}),(0,l.jsx)("button",{type:"button",onClick:function(){F(e=>({...e,medicalQualifications:[...e.medicalQualifications||[],{degree:"",institution:"",year:""}]}))},className:"px-3 py-1 text-xs rounded bg-slate-800 border border-slate-700 text-white hover:bg-slate-700 transition",children:"Add"})]}),(0,l.jsx)("div",{className:"space-y-3",children:(T.medicalQualifications||[]).map((e,t)=>(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3 items-start",children:[(0,l.jsxs)("div",{className:"flex flex-col",children:[(0,l.jsx)("label",{className:"text-xs text-slate-400",children:"Degree (required)"}),(0,l.jsx)("input",{className:x,value:e.degree,onChange:e=>q(t,"degree",e.target.value),placeholder:"e.g., MD, MBBS",required:!0})]}),(0,l.jsxs)("div",{className:"flex flex-col",children:[(0,l.jsx)("label",{className:"text-xs text-slate-400",children:"Institution"}),(0,l.jsx)("input",{className:x,value:e.institution||"",onChange:e=>q(t,"institution",e.target.value),placeholder:"e.g., Johns Hopkins"})]}),(0,l.jsxs)("div",{className:"flex flex-col",children:[(0,l.jsx)("label",{className:"text-xs text-slate-400",children:"Year"}),(0,l.jsxs)("div",{className:"flex gap-2",children:[(0,l.jsx)("input",{className:x,value:e.year||"",onChange:e=>q(t,"year",e.target.value),placeholder:"e.g., 2015"}),(0,l.jsx)("button",{type:"button",onClick:()=>{F(e=>({...e,medicalQualifications:(e.medicalQualifications||[]).filter((e,a)=>a!==t)}))},className:"px-3 py-2 text-xs rounded bg-rose-500/20 text-rose-200 hover:bg-rose-500/30 border border-rose-500/30 transition",children:"Remove"})]})]})]},t))})]}),(0,l.jsxs)("div",{className:"space-y-3 rounded-2xl border border-slate-800 bg-slate-900/60 p-4",children:[(0,l.jsx)("div",{className:"flex items-center justify-between",children:(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-sm font-semibold text-white",children:"Media"}),(0,l.jsx)("p",{className:"text-xs text-slate-400",children:"Styled to match the patient review uploader."})]})}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,l.jsxs)(p,{title:"Profile photo",helper:"Drop or click to upload the main headshot.",children:[(0,l.jsxs)("div",{className:"border-2 border-dashed border-slate-700 bg-slate-900/60 rounded-xl p-4 flex flex-col gap-3 items-center justify-center text-slate-300 cursor-pointer hover:border-teal-500 transition",onDragOver:e=>e.preventDefault(),onDrop:function(e){var t;e.preventDefault();let a=null===(t=e.dataTransfer.files)||void 0===t?void 0:t[0];a&&G(a)},onClick:()=>{var e;return null===(e=m.current)||void 0===e?void 0:e.click()},children:[(0,l.jsx)("input",{type:"file",accept:"image/*",ref:m,className:"hidden",onChange:function(e){var t;let a=null===(t=e.target.files)||void 0===t?void 0:t[0];a&&G(a)}}),(0,l.jsxs)("div",{className:"text-center space-y-1",children:[(0,l.jsx)("p",{className:"font-medium",children:"Drop an image here or click to upload"}),(0,l.jsx)("p",{className:"text-xs text-slate-500",children:"Recommended: square, under 5MB. JPG or PNG."})]}),D&&(0,l.jsxs)("p",{className:"text-xs text-teal-300",children:["Selected: ",D]})]}),P&&(0,l.jsxs)("div",{className:"w-full grid grid-cols-1 md:grid-cols-[140px_1fr] gap-3 items-center",children:[(0,l.jsx)("img",{src:P,alt:"Preview",className:"w-full max-w-[140px] h-28 object-cover rounded-lg border border-slate-700"}),(0,l.jsx)("p",{className:"text-xs text-slate-400",children:"This preview will be uploaded to Cloudinary and saved."})]})]}),(0,l.jsxs)(p,{title:"Gallery images",helper:"Upload additional photos.",children:[(0,l.jsx)(h,{accept:"image/png,image/jpeg,image/webp",multiple:!0,onChange:function(e){Array.from(e.target.files||[]).forEach(e=>{let t=new FileReader;t.onloadend=()=>{F(e=>({...e,galleryImages:[...e.galleryImages||[],t.result.toString()]}))},t.readAsDataURL(e)})},label:"Upload images"}),(T.galleryImages||[]).length>0&&(0,l.jsx)("div",{className:"flex flex-wrap gap-2",children:T.galleryImages.map((e,t)=>(0,l.jsx)(f,{src:e,onRemove:()=>{F(e=>({...e,galleryImages:(e.galleryImages||[]).filter((e,a)=>a!==t)}))}},e+t))}),(0,l.jsx)("p",{className:"text-[11px] text-slate-500",children:"Accepted: JPG/PNG/WEBP. Max 10 images."})]}),(0,l.jsxs)(p,{title:"Profile video",helper:"Upload a video or paste a link.",children:[(0,l.jsx)(h,{accept:"video/mp4,video/quicktime,video/webm",onChange:function(e){var t;let a=null===(t=e.target.files)||void 0===t?void 0:t[0];if(!a)return;let l=new FileReader;l.onloadend=()=>{E(l.result.toString()),Q(URL.createObjectURL(a)),F(e=>({...e,videoUrl:""}))},l.readAsDataURL(a)},label:"Upload video file"}),(0,l.jsx)("input",{name:"videoUrl",value:T.videoUrl,onChange:L,className:x,placeholder:"https://youtube.com/embed/..."}),M||T.videoUrl?(0,l.jsx)("div",{className:"overflow-hidden rounded-lg border border-slate-700 bg-black",children:(0,l.jsx)("iframe",{src:M||T.videoUrl,className:"w-full aspect-video",title:"Doctor video preview",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share",allowFullScreen:!0})}):null]})]})]})]})]}),(0,l.jsxs)("div",{className:"mt-auto border-t border-slate-800 bg-[#0b1017] px-6 py-4 flex justify-end gap-3",children:[(0,l.jsx)("button",{type:"button",onClick:()=>d.push("/admin/doctors"),className:"px-4 py-2 rounded-lg bg-slate-800 text-white hover:bg-slate-700 transition",children:"Cancel"}),(0,l.jsx)("button",{type:"submit",onClick:J,disabled:w||v,className:"px-4 py-2 rounded-lg bg-teal-600 text-white hover:bg-teal-500 transition disabled:opacity-70",children:w?"Updating...":"Update"})]})]})})}function p(e){let{title:t,helper:a,children:s}=e;return(0,l.jsxs)("div",{className:"space-y-3 rounded-xl border border-slate-800 bg-slate-900/70 p-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-sm font-semibold text-white",children:t}),a?(0,l.jsx)("p",{className:"text-xs text-slate-400",children:a}):null]}),(0,l.jsx)("div",{className:"space-y-2",children:s})]})}function h(e){let{accept:t,multiple:a,onChange:s,label:r}=e;return(0,l.jsxs)("label",{className:"flex flex-col items-center justify-center gap-2 rounded-xl border border-dashed border-slate-700 bg-slate-900/60 p-4 text-slate-300 cursor-pointer hover:border-teal-500 hover:bg-slate-900",children:[(0,l.jsx)("input",{type:"file",accept:t,multiple:a,className:"hidden",onChange:e=>{s&&s(e)}}),(0,l.jsx)("span",{className:"text-xs text-slate-400",children:r}),(0,l.jsx)("span",{className:"text-[11px] text-slate-500",children:t||""})]})}function f(e){let{src:t,onRemove:a}=e;return(0,l.jsxs)("div",{className:"relative h-20 w-20 rounded-lg overflow-hidden border border-slate-700 bg-slate-800",children:[(0,l.jsx)("img",{src:t,className:"h-full w-full object-cover",alt:"Gallery"}),(0,l.jsx)("button",{type:"button",onClick:a,className:"absolute top-1 right-1 bg-black/70 text-white rounded-full text-xs px-1",children:"\xd7"})]})}},32617:function(e,t,a){"use strict";a.d(t,{QW:function(){return c},R1:function(){return i},f8:function(){return r},nc:function(){return u},pE:function(){return d},sg:function(){return o}});let l="http://localhost:5000/api".replace(/\/$/,""),s=l.endsWith("/api")?l:"".concat(l,"/api");function r(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=e.startsWith("/")?e:"/".concat(e),a="".concat(s).concat(t);return console.log("[api] request url:",a),a}async function n(e){let t=await e.json().catch(()=>({}));if(!e.ok){let a=Error((null==t?void 0:t.message)||"Request failed");throw a.status=e.status,a}return t}async function i(e){return n(await fetch(r(e),{method:"GET",credentials:"include"}))}async function o(e,t){let a="undefined"!=typeof FormData&&t instanceof FormData;return n(await fetch(r(e),{method:"POST",credentials:"include",headers:a?void 0:{"Content-Type":"application/json"},body:a?t:JSON.stringify(t||{})}))}async function d(e,t){let a="undefined"!=typeof FormData&&t instanceof FormData;return n(await fetch(r(e),{method:"PUT",credentials:"include",headers:a?void 0:{"Content-Type":"application/json"},body:a?t:JSON.stringify(t||{})}))}async function c(e){return n(await fetch(r(e),{method:"DELETE",credentials:"include"}))}async function u(e,t){return n(await fetch(r(e),{method:"PATCH",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(t||{})}))}},30166:function(e,t,a){"use strict";a.d(t,{default:function(){return s.a}});var l=a(55775),s=a.n(l)},99376:function(e,t,a){"use strict";var l=a(35475);a.o(l,"useParams")&&a.d(t,{useParams:function(){return l.useParams}}),a.o(l,"usePathname")&&a.d(t,{usePathname:function(){return l.usePathname}}),a.o(l,"useRouter")&&a.d(t,{useRouter:function(){return l.useRouter}}),a.o(l,"useSearchParams")&&a.d(t,{useSearchParams:function(){return l.useSearchParams}})},55775:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return r}});let l=a(60917);a(57437),a(2265);let s=l._(a(15602));function r(e,t){var a;let l={loading:e=>{let{error:t,isLoading:a,pastDelay:l}=e;return null}};"function"==typeof e&&(l.loader=e);let r={...l,...t};return(0,s.default)({...r,modules:null==(a=r.loadableGenerated)?void 0:a.modules})}("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},81523:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"BailoutToCSR",{enumerable:!0,get:function(){return s}});let l=a(18993);function s(e){let{reason:t,children:a}=e;if("undefined"==typeof window)throw new l.BailoutToCSRError(t);return a}},15602:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return d}});let l=a(57437),s=a(2265),r=a(81523),n=a(70049);function i(e){return{default:e&&"default"in e?e.default:e}}let o={loader:()=>Promise.resolve(i(()=>null)),loading:null,ssr:!0},d=function(e){let t={...o,...e},a=(0,s.lazy)(()=>t.loader().then(i)),d=t.loading;function c(e){let i=d?(0,l.jsx)(d,{isLoading:!0,pastDelay:!0,error:null}):null,o=t.ssr?(0,l.jsxs)(l.Fragment,{children:["undefined"==typeof window?(0,l.jsx)(n.PreloadCss,{moduleIds:t.modules}):null,(0,l.jsx)(a,{...e})]}):(0,l.jsx)(r.BailoutToCSR,{reason:"next/dynamic",children:(0,l.jsx)(a,{...e})});return(0,l.jsx)(s.Suspense,{fallback:i,children:o})}return c.displayName="LoadableComponent",c}},70049:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"PreloadCss",{enumerable:!0,get:function(){return r}});let l=a(57437),s=a(20544);function r(e){let{moduleIds:t}=e;if("undefined"!=typeof window)return null;let a=(0,s.getExpectedRequestStore)("next/dynamic css"),r=[];if(a.reactLoadableManifest&&t){let e=a.reactLoadableManifest;for(let a of t){if(!e[a])continue;let t=e[a].files.filter(e=>e.endsWith(".css"));r.push(...t)}}return 0===r.length?null:(0,l.jsx)(l.Fragment,{children:r.map(e=>(0,l.jsx)("link",{precedence:"dynamic",rel:"stylesheet",href:a.assetPrefix+"/_next/"+encodeURI(e),as:"style"},e))})}},98527:function(){}},function(e){e.O(0,[6458,7142,7837,2971,2117,1744],function(){return e(e.s=91176)}),_N_E=e.O()}]);