(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5920],{71221:function(e,t,n){Promise.resolve().then(n.bind(n,23597))},23597:function(e,t,n){"use strict";n.d(t,{default:function(){return i}});var a=n(57437),u=n(2265),r=n(1233);function i(){let{login:e,error:t}=(0,r.a)(),[n,i]=(0,u.useState)(""),[s,o]=(0,u.useState)(""),[c,l]=(0,u.useState)(""),[d,f]=(0,u.useState)(!1);async function h(t){t.preventDefault(),l(""),f(!0);try{await e(n,s)}catch(e){l(e.message||"Login failed")}finally{f(!1)}}return(0,a.jsxs)("form",{onSubmit:h,className:"space-y-4 max-w-sm mx-auto",children:[(0,a.jsx)("input",{type:"email",placeholder:"Email",className:"border p-2 rounded w-full",value:n,onChange:e=>i(e.target.value),required:!0}),(0,a.jsx)("input",{type:"password",placeholder:"Password",className:"border p-2 rounded w-full",value:s,onChange:e=>o(e.target.value),required:!0}),(c||t)&&(0,a.jsx)("p",{className:"text-red-600 text-sm",children:c||t}),(0,a.jsx)("button",{type:"submit",className:"w-full bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 disabled:bg-blue-300",disabled:d,children:d?"Logging in...":"Login"})]})}},1233:function(e,t,n){"use strict";n.d(t,{AuthProvider:function(){return o},a:function(){return c}});var a=n(57437),u=n(2265),r=n(99376),i=n(32617);let s=(0,u.createContext)(null);function o(e){let{children:t}=e,[n,o]=(0,u.useState)(null),[c,l]=(0,u.useState)(!0),[d,f]=(0,u.useState)(""),h=(0,r.useRouter)();async function m(){try{let e=await (0,i.R1)("/auth/me");o(e.data||null),f("")}catch(e){o(null),f("")}finally{l(!1)}}async function p(e,t){l(!0);try{let n=await (0,i.sg)("/auth/login",{email:e,password:t});o(n.data||null),f(""),h.push("/admin")}catch(e){throw f(e.message||"Login failed"),o(null),e}finally{l(!1)}}async function y(){try{await (0,i.sg)("/auth/logout")}catch(e){}o(null),h.push("/admin/login")}return(0,u.useEffect)(()=>{m()},[]),(0,a.jsx)(s.Provider,{value:{user:n,loading:c,error:d,login:p,logout:y,refresh:m},children:t})}function c(){return(0,u.useContext)(s)}},32617:function(e,t,n){"use strict";n.d(t,{QW:function(){return l},R1:function(){return s},f8:function(){return r},nc:function(){return d},pE:function(){return c},sg:function(){return o}});let a="http://localhost:5000/api".replace(/\/$/,""),u=a.endsWith("/api")?a:"".concat(a,"/api");function r(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=e.startsWith("/")?e:"/".concat(e),n="".concat(u).concat(t);return console.log("[api] request url:",n),n}async function i(e){let t=await e.json().catch(()=>({}));if(!e.ok){let n=Error((null==t?void 0:t.message)||"Request failed");throw n.status=e.status,n}return t}async function s(e){return i(await fetch(r(e),{method:"GET",credentials:"include"}))}async function o(e,t){let n="undefined"!=typeof FormData&&t instanceof FormData;return i(await fetch(r(e),{method:"POST",credentials:"include",headers:n?void 0:{"Content-Type":"application/json"},body:n?t:JSON.stringify(t||{})}))}async function c(e,t){let n="undefined"!=typeof FormData&&t instanceof FormData;return i(await fetch(r(e),{method:"PUT",credentials:"include",headers:n?void 0:{"Content-Type":"application/json"},body:n?t:JSON.stringify(t||{})}))}async function l(e){return i(await fetch(r(e),{method:"DELETE",credentials:"include"}))}async function d(e,t){return i(await fetch(r(e),{method:"PATCH",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(t||{})}))}},99376:function(e,t,n){"use strict";var a=n(35475);n.o(a,"useParams")&&n.d(t,{useParams:function(){return a.useParams}}),n.o(a,"usePathname")&&n.d(t,{usePathname:function(){return a.usePathname}}),n.o(a,"useRouter")&&n.d(t,{useRouter:function(){return a.useRouter}}),n.o(a,"useSearchParams")&&n.d(t,{useSearchParams:function(){return a.useSearchParams}})}},function(e){e.O(0,[2971,2117,1744],function(){return e(e.s=71221)}),_N_E=e.O()}]);