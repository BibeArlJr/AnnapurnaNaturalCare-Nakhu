(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7630],{43151:function(e,t,s){Promise.resolve().then(s.bind(s,41148))},41148:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return g}});var l=s(57437),a=s(2265),i=s(32617),r=s(66610),n=s(43836),o=s(99588),d=s(61601),c=s(65223),x=s(46243),m=s(14663),u=s(30166);s(98527);let p=(0,u.default)(()=>Promise.all([s.e(3070),s.e(1804)]).then(s.t.bind(s,5600,23)),{loadableGenerated:{webpack:()=>[5600]},ssr:!1}),h={title:"",slug:"",category:"",description:"",duration:"",certificationInfo:"",mode:"online",price:"",syllabus:[{topic:"Topic",items:[""]}],overview:"",detailedDescription:"",coverImage:"",galleryImages:[],promoVideos:[],videoUrl:"",isPublished:!1};function g(){let[e,t]=(0,a.useState)([]),[s,u]=(0,a.useState)([]),[g,b]=(0,a.useState)(!0),[v,f]=(0,a.useState)(!1),[y,j]=(0,a.useState)(h),[N,w]=(0,a.useState)(null),[C,k]=(0,a.useState)(!1),[I,S]=(0,a.useState)(!1),[_,E]=(0,a.useState)(null),P=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return e.toString().toLowerCase().trim().replace(/[^a-z0-9]+/g,"-").replace(/^-+|-+$/g,"")},D=async()=>{b(!0);try{let[e,s]=await Promise.all([(0,i.R1)("/courses"),(0,i.R1)("/course-categories/active")]);t((null==e?void 0:e.data)||e||[]),u((null==s?void 0:s.data)||s||[])}catch(e){console.error("Courses admin load error:",e)}finally{b(!1)}};(0,a.useEffect)(()=>{D()},[]);let L=async e=>{E(e._id);try{let s=await (0,i.pE)("/courses/".concat(e._id),{isPublished:!e.isPublished}),l=(null==s?void 0:s.data)||s;t(t=>t.map(t=>t._id===e._id?{...t,...l}:t))}catch(e){alert((0,r.i)(e,"Failed to update publish status"))}finally{E(null)}},A=e=>{var t,s;w(e);let l=Array.from(new Set(Array.isArray(e.promoVideos)?e.promoVideos.map(e=>"string"==typeof e?e:null==e?void 0:e.url).filter(Boolean):[]));j({...h,...e,syllabus:(e.syllabusNormalized||e.syllabus||[]).map(e=>({topic:e.topic||e.title||"",items:Array.isArray(e.items)?e.items:e.content?[e.content]:[]})),price:null!==(s=e.price)&&void 0!==s?s:"",category:(null===(t=e.category)||void 0===t?void 0:t._id)||e.category||"",overview:e.overview||e.description||"",detailedDescription:e.detailedDescription||e.description||"",galleryImages:e.galleryImages||[],promoVideos:l,videoUrl:e.videoUrl||l[0]||""}),S(!0),f(!0)},V=e=>{let{name:t,value:s,type:l,checked:a}=e.target,i="checkbox"===l?a:s;if("title"===t&&!I){j(e=>({...e,title:i,slug:P(i)}));return}"slug"===t&&S(!0),j(e=>({...e,[t]:i}))},U=(e,t)=>{j(s=>{let l=[...s.syllabus];return l[e].topic=t,{...s,syllabus:l}})},B=e=>{j(t=>({...t,syllabus:t.syllabus.filter((t,s)=>s!==e)}))},O=e=>{j(t=>{let s=[...t.syllabus],l=s[e].items||[];return s[e].items=[...l,""],{...t,syllabus:s}})},T=(e,t,s)=>{j(l=>{let a=[...l.syllabus],i=a[e].items||[];return i[t]=s,a[e].items=i,{...l,syllabus:a}})},Z=(e,t)=>{j(s=>{let l=[...s.syllabus];return l[e].items=l[e].items.filter((e,s)=>s!==t),{...s,syllabus:l}})},R=async()=>{if(!y.title.trim()){alert("Title is required");return}let e=y.overview.replace(/<[^>]+>/g," ").trim();if((e?e.split(/\s+/).filter(Boolean).length:0)>50){alert("Overview should be 50 words or fewer.");return}k(!0);try{let e=(y.syllabus||[]).filter(e=>e.topic&&(e.items||[]).some(e=>e&&e.trim()));if(!e.length){alert("Add at least one topic with a sub-topic in the syllabus."),k(!1);return}let t=[...y.promoVideos||[],y.videoUrl].map(e=>"string"==typeof e?e:null==e?void 0:e.url).filter(Boolean),s=Array.from(new Set(t)),l={title:y.title,slug:y.slug,category:y.category||void 0,overview:y.overview,detailedDescription:y.detailedDescription,description:y.detailedDescription||y.overview,duration:y.duration,certificationInfo:y.certificationInfo,mode:y.mode,price:""===y.price?0:Number(y.price),syllabus:e.map(e=>({topic:e.topic,items:(e.items||[]).filter(e=>e&&e.trim())})),coverImage:y.coverImage,galleryImages:y.galleryImages,promoVideos:s,videoUrl:s[0]||"",isPublished:y.isPublished};N?await (0,i.pE)("/courses/".concat(N._id),l):await (0,i.sg)("/courses",l),f(!1),w(null),j(h),D()}catch(e){alert((0,r.i)(e,"Failed to save course"))}finally{k(!1)}},W=async e=>{if(confirm("Delete this course?"))try{await (0,i.QW)("/courses/".concat(e)),D()}catch(e){alert((0,r.i)(e,"Delete failed"))}};return(0,l.jsxs)("div",{className:"space-y-6",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h1",{className:"text-2xl font-semibold text-white",children:"Courses"}),(0,l.jsx)("p",{className:"text-sm text-slate-400",children:"Yoga Teacher Training, Online Courses, Sound Healing."})]}),(0,l.jsxs)("button",{onClick:()=>{var e;j({...h,category:(null===(e=s[0])||void 0===e?void 0:e._id)||""}),S(!1),w(null),f(!0)},className:"inline-flex items-center gap-2 bg-teal-600 hover:bg-teal-500 text-white px-4 py-2 rounded-lg transition",children:[(0,l.jsx)(n.Z,{className:"h-5 w-5"}),"Add Course"]})]}),g?(0,l.jsx)("p",{className:"text-slate-400 text-sm",children:"Loading..."}):0===e.length?(0,l.jsx)("div",{className:"text-slate-400 text-sm bg-slate-900 border border-slate-800 rounded-lg p-6",children:"No courses yet."}):(0,l.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-3 gap-4",children:e.map(e=>(0,l.jsxs)("div",{className:"rounded-xl border border-white/10 bg-[#0f131a] p-4 space-y-3 shadow-sm",children:[(0,l.jsx)("div",{className:"rounded-lg overflow-hidden bg-slate-800 h-32 border border-slate-800",children:e.coverImage?(0,l.jsx)("img",{src:e.coverImage,alt:e.title,className:"w-full h-full object-cover"}):(0,l.jsx)("div",{className:"w-full h-full flex items-center justify-center text-slate-500 text-xs",children:"No image"})}),(0,l.jsxs)("div",{className:"flex items-start justify-between gap-2",children:[(0,l.jsxs)("div",{className:"space-y-1",children:[(0,l.jsx)("p",{className:"text-white font-semibold line-clamp-2",children:e.title}),(0,l.jsx)("p",{className:"text-xs text-slate-400",children:e.category})]}),(0,l.jsxs)("div",{className:"flex flex-col items-end gap-1",children:[(0,l.jsx)("span",{className:"px-3 py-1 rounded-full text-xs ".concat(e.isPublished?"bg-green-900/60 text-green-300":"bg-slate-800 text-slate-300"),children:e.isPublished?"Published":"Draft"}),(0,l.jsx)(m.W,{status:e.isPublished?"published":"draft",onToggle:()=>L(e),disabled:_===e._id})]})]}),(0,l.jsx)("p",{className:"text-sm text-slate-300 line-clamp-2",children:e.description}),(0,l.jsxs)("div",{className:"flex gap-2 pt-2",children:[(0,l.jsxs)("button",{onClick:()=>A(e),className:"inline-flex items-center gap-1 px-3 py-1.5 rounded-lg bg-slate-800 hover:bg-slate-700 text-slate-100 text-sm",children:[(0,l.jsx)(o.Z,{className:"h-4 w-4"}),"Edit"]}),(0,l.jsxs)("button",{onClick:()=>W(e._id),className:"inline-flex items-center gap-1 px-3 py-1.5 rounded-lg bg-red-900/60 hover:bg-red-800 text-red-100 text-sm",children:[(0,l.jsx)(d.Z,{className:"h-4 w-4"}),"Delete"]})]})]},e._id))}),v&&(0,l.jsx)("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-center justify-center px-4 py-8",children:(0,l.jsxs)("div",{className:"w-full max-w-5xl max-h-[90vh] bg-[#0f131a] border border-white/10 rounded-2xl shadow-2xl overflow-hidden flex flex-col",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between px-6 py-4 border-b border-slate-800",children:[(0,l.jsxs)("div",{children:[(0,l.jsxs)("h2",{className:"text-xl font-semibold text-white",children:[N?"Edit":"Add"," Course"]}),(0,l.jsx)("p",{className:"text-sm text-slate-400",children:"Courses are separate from health packages and retreats."})]}),(0,l.jsx)("button",{onClick:()=>f(!1),className:"text-slate-400 hover:text-white text-xl leading-none",children:"\xd7"})]}),(0,l.jsxs)("div",{className:"flex-1 overflow-y-auto px-6 py-4 space-y-4",children:[(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,l.jsxs)("div",{className:"space-y-1",children:[(0,l.jsx)("label",{className:"text-sm text-slate-300",children:"Title"}),(0,l.jsx)("input",{name:"title",value:y.title,onChange:V,className:"w-full bg-slate-900 border border-slate-700 rounded-lg px-4 py-3 text-white"})]}),(0,l.jsxs)("div",{className:"space-y-1",children:[(0,l.jsx)("label",{className:"text-sm text-slate-300",children:"Slug"}),(0,l.jsx)("input",{name:"slug",value:y.slug,onChange:V,className:"w-full bg-slate-900 border border-slate-700 rounded-lg px-4 py-3 text-white"})]}),(0,l.jsxs)("div",{className:"space-y-1",children:[(0,l.jsx)("label",{className:"text-sm text-slate-300",children:"Category"}),(0,l.jsxs)("select",{name:"category",value:y.category,onChange:V,className:"w-full bg-slate-900 border border-slate-700 rounded-lg px-4 py-3 text-white",children:[(0,l.jsx)("option",{value:"",children:"Select category"}),s.map(e=>(0,l.jsx)("option",{value:e._id,children:e.name},e._id))]}),0===s.length&&(0,l.jsx)("p",{className:"text-xs text-teal-200",children:"Create categories first in the Course Categories tab."})]}),(0,l.jsxs)("div",{className:"space-y-1",children:[(0,l.jsx)("label",{className:"text-sm text-slate-300",children:"Mode"}),(0,l.jsxs)("select",{name:"mode",value:y.mode,onChange:V,className:"w-full bg-slate-900 border border-slate-700 rounded-lg px-4 py-3 text-white",children:[(0,l.jsx)("option",{value:"online",children:"Online"}),(0,l.jsx)("option",{value:"residential",children:"Residential"})]})]}),(0,l.jsxs)("div",{className:"space-y-1",children:[(0,l.jsx)("label",{className:"text-sm text-slate-300",children:"Duration"}),(0,l.jsx)("input",{name:"duration",value:y.duration,onChange:V,className:"w-full bg-slate-900 border border-slate-700 rounded-lg px-4 py-3 text-white"})]}),(0,l.jsxs)("div",{className:"space-y-1",children:[(0,l.jsx)("label",{className:"text-sm text-slate-300",children:"Price (USD)"}),(0,l.jsx)("input",{name:"price",type:"number",value:y.price,onChange:V,className:"w-full bg-slate-900 border border-slate-700 rounded-lg px-4 py-3 text-white"})]})]}),(0,l.jsxs)("div",{className:"space-y-1",children:[(0,l.jsx)("label",{className:"text-sm text-slate-300",children:"Cover image"}),(0,l.jsx)(x.Z,{accept:"image/*",maxItems:1,value:y.coverImage?[y.coverImage]:[],onChange:e=>j(t=>({...t,coverImage:e[0]||""}))})]}),(0,l.jsxs)("div",{className:"space-y-1",children:[(0,l.jsx)("label",{className:"text-sm text-slate-300",children:"Overview (max ~300 words)"}),(0,l.jsx)("div",{className:"bg-slate-900 border border-slate-700 rounded-lg",children:(0,l.jsx)(p,{theme:"snow",value:y.overview,onChange:e=>j(t=>e.replace(/<[^>]+>/g," ").trim().split(/\s+/).filter(Boolean).length>50?t:{...t,overview:e})})}),(0,l.jsxs)("p",{className:"text-xs text-slate-400",children:[y.overview.replace(/<[^>]+>/g,"").trim().split(/\s+/).filter(Boolean).length," / 50 words"]})]}),(0,l.jsxs)("div",{className:"space-y-1",children:[(0,l.jsx)("label",{className:"text-sm text-slate-300",children:"Detailed description"}),(0,l.jsx)("div",{className:"bg-slate-900 border border-slate-700 rounded-lg",children:(0,l.jsx)(p,{theme:"snow",value:y.detailedDescription,onChange:e=>j(t=>({...t,detailedDescription:e}))})}),(0,l.jsxs)("p",{className:"text-xs text-slate-400",children:[y.detailedDescription.replace(/<[^>]+>/g,"").trim().split(/\s+/).filter(Boolean).length," / 50 words max"]})]}),(0,l.jsxs)("div",{className:"space-y-1",children:[(0,l.jsx)("label",{className:"text-sm text-slate-300",children:"Certification info"}),(0,l.jsx)("input",{name:"certificationInfo",value:y.certificationInfo,onChange:V,className:"w-full bg-slate-900 border border-slate-700 rounded-lg px-4 py-3 text-white"})]}),(0,l.jsx)(c.Z,{title:"Media",images:y.galleryImages,setImages:e=>j(t=>({...t,galleryImages:e})),videos:y.promoVideos,setVideos:e=>j(t=>({...t,promoVideos:e})),maxImages:10,maxVideos:3,showVideoUpload:!1}),(0,l.jsxs)("div",{className:"space-y-1",children:[(0,l.jsx)("label",{className:"text-sm text-slate-300",children:"YouTube link (optional)"}),(0,l.jsx)("input",{type:"text",value:y.videoUrl,onChange:e=>j(t=>({...t,videoUrl:e.target.value})),placeholder:"Paste a YouTube URL",className:"w-full bg-slate-900 border border-slate-700 rounded-lg px-4 py-3 text-white"})]}),(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsx)("label",{className:"text-sm text-slate-300",children:"Syllabus"}),(0,l.jsx)("button",{onClick:()=>{j(e=>({...e,syllabus:[...e.syllabus,{topic:"",items:[""]}]}))},type:"button",className:"text-xs text-teal-300",children:"+ Add topic"})]}),(0,l.jsx)("div",{className:"space-y-3",children:y.syllabus.map((e,t)=>(0,l.jsxs)("div",{className:"border border-slate-800 rounded-lg p-3 space-y-2 bg-slate-900",children:[(0,l.jsxs)("div",{className:"flex items-start gap-2",children:[(0,l.jsx)("input",{value:e.topic,onChange:e=>U(t,e.target.value),className:"flex-1 bg-slate-800 border border-slate-700 rounded-lg px-3 py-2 text-white",placeholder:"Topic title"}),y.syllabus.length>1&&(0,l.jsx)("button",{onClick:()=>B(t),type:"button",className:"px-2 py-1 rounded-lg bg-red-900/60 text-red-100 text-xs",children:"Remove"})]}),(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsx)("p",{className:"text-xs text-slate-300",children:"Sub-topics"}),(0,l.jsx)("button",{type:"button",onClick:()=>O(t),className:"text-xs text-teal-300",children:"+ Add sub-topic"})]}),(e.items||[]).map((s,a)=>(0,l.jsxs)("div",{className:"flex gap-2",children:[(0,l.jsx)("input",{value:s,onChange:e=>T(t,a,e.target.value),className:"flex-1 bg-slate-800 border border-slate-700 rounded-lg px-3 py-2 text-white",placeholder:"Sub-topic"}),e.items.length>1&&(0,l.jsx)("button",{type:"button",onClick:()=>Z(t,a),className:"px-2 py-2 rounded-lg bg-red-900/60 text-red-100 text-xs",children:"\xd7"})]},a))]})]},t))})]}),(0,l.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,l.jsx)("input",{type:"checkbox",name:"isPublished",checked:y.isPublished,onChange:V}),(0,l.jsx)("label",{className:"text-sm text-slate-300",children:"Published"})]})]}),(0,l.jsxs)("div",{className:"px-6 py-4 border-t border-slate-800 flex justify-end gap-3",children:[(0,l.jsx)("button",{onClick:()=>f(!1),className:"px-4 py-2 rounded-lg bg-slate-800 text-white",children:"Cancel"}),(0,l.jsx)("button",{onClick:R,disabled:C,className:"px-4 py-2 rounded-lg bg-teal-600 text-white disabled:opacity-60",children:C?"Saving...":N?"Save changes":"Create Course"})]})]})})]})}},99588:function(e,t,s){"use strict";var l=s(2265);let a=l.forwardRef(function(e,t){let{title:s,titleId:a,...i}=e;return l.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":a},i),s?l.createElement("title",{id:a},s):null,l.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10"}))});t.Z=a},43836:function(e,t,s){"use strict";var l=s(2265);let a=l.forwardRef(function(e,t){let{title:s,titleId:a,...i}=e;return l.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":a},i),s?l.createElement("title",{id:a},s):null,l.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4.5v15m7.5-7.5h-15"}))});t.Z=a},61601:function(e,t,s){"use strict";var l=s(2265);let a=l.forwardRef(function(e,t){let{title:s,titleId:a,...i}=e;return l.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":a},i),s?l.createElement("title",{id:a},s):null,l.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"}))});t.Z=a}},function(e){e.O(0,[6458,9038,2971,2117,1744],function(){return e(e.s=43151)}),_N_E=e.O()}]);