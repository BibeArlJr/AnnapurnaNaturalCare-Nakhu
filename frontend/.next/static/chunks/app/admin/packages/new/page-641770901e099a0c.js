(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9175],{42209:function(e,t,n){Promise.resolve().then(n.bind(n,58546))},58546:function(e,t,n){"use strict";n.d(t,{default:function(){return u}});var a=n(57437),r=n(2265),i=n(99376),s=n(32617);function u(e){var t,n;let{mode:u,initialData:c}=e,o=(0,i.useRouter)(),[l,d]=(0,r.useState)({title:(null==c?void 0:c.title)||"",description:(null==c?void 0:c.description)||"",price:(null==c?void 0:c.price)||"",images:(null==c?void 0:null===(t=c.images)||void 0===t?void 0:t.join(", "))||"",featured:(null==c?void 0:c.featured)||(null==c?void 0:c.isFeatured)||!1,departments:(null==c?void 0:null===(n=c.departments)||void 0===n?void 0:n.map(e=>(null==e?void 0:e._id)||e))||[]}),[p,f]=(0,r.useState)([]);function m(e,t){d({...l,[e]:t})}async function h(e){e.preventDefault();let t={title:l.title,description:l.description,price:l.price,images:l.images.split(",").map(e=>e.trim()).filter(Boolean),featured:l.featured,departments:l.departments};try{"create"===u?await (0,s.sg)("/packages",t):await (0,s.pE)("/packages/".concat(c._id),t),o.push("/admin/packages")}catch(e){alert(e.message||"Failed")}}return(0,r.useEffect)(()=>{!async function(){try{let e=await (0,s.R1)("/departments");f((null==e?void 0:e.data)||e||[])}catch(e){console.error("Department fetch error",e)}}()},[]),(0,a.jsxs)("form",{onSubmit:h,className:"space-y-4 max-w-xl",children:[(0,a.jsx)("input",{className:"border p-2 rounded w-full",placeholder:"Title",value:l.title,onChange:e=>m("title",e.target.value),required:!0}),(0,a.jsx)("textarea",{className:"border p-2 rounded w-full h-20",placeholder:"Description",value:l.description,onChange:e=>m("description",e.target.value)}),(0,a.jsx)("input",{type:"number",className:"border p-2 rounded w-full",placeholder:"Price",value:l.price,onChange:e=>m("price",e.target.value)}),(0,a.jsx)("input",{className:"border p-2 rounded w-full",placeholder:"Image URLs (comma separated)",value:l.images,onChange:e=>m("images",e.target.value)}),(0,a.jsxs)("div",{className:"border p-3 rounded space-y-2",children:[(0,a.jsx)("p",{className:"text-sm font-medium",children:"Departments"}),(0,a.jsx)("div",{className:"flex flex-wrap gap-2",children:p.map(e=>{let t=l.departments.includes(e._id);return(0,a.jsx)("button",{type:"button",onClick:()=>{var t;return t=e._id,void d(e=>{let n=e.departments.includes(t);return{...e,departments:n?e.departments.filter(e=>e!==t):[...e.departments,t]}})},className:"px-3 py-1 rounded-full text-sm border ".concat(t?"bg-blue-100 border-blue-400 text-blue-700":"bg-gray-100 border-gray-300 text-gray-700"),children:e.name},e._id)})})]}),(0,a.jsxs)("label",{className:"flex items-center gap-2",children:[(0,a.jsx)("input",{type:"checkbox",checked:l.featured,onChange:e=>m("featured",e.target.checked)}),"Featured"]}),(0,a.jsx)("button",{type:"submit",className:"bg-blue-600 text-white px-4 py-2 rounded",children:"create"===u?"Add Package":"Update Package"})]})}},32617:function(e,t,n){"use strict";n.d(t,{QW:function(){return l},R1:function(){return u},f8:function(){return i},nc:function(){return d},pE:function(){return o},sg:function(){return c}});let a="http://localhost:5000/api".replace(/\/$/,""),r=a.endsWith("/api")?a:"".concat(a,"/api");function i(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=e.startsWith("/")?e:"/".concat(e),n="".concat(r).concat(t);return console.log("[api] request url:",n),n}async function s(e){let t=await e.json().catch(()=>({}));if(!e.ok){let n=Error((null==t?void 0:t.message)||"Request failed");throw n.status=e.status,n}return t}async function u(e){return s(await fetch(i(e),{method:"GET",credentials:"include"}))}async function c(e,t){let n="undefined"!=typeof FormData&&t instanceof FormData;return s(await fetch(i(e),{method:"POST",credentials:"include",headers:n?void 0:{"Content-Type":"application/json"},body:n?t:JSON.stringify(t||{})}))}async function o(e,t){let n="undefined"!=typeof FormData&&t instanceof FormData;return s(await fetch(i(e),{method:"PUT",credentials:"include",headers:n?void 0:{"Content-Type":"application/json"},body:n?t:JSON.stringify(t||{})}))}async function l(e){return s(await fetch(i(e),{method:"DELETE",credentials:"include"}))}async function d(e,t){return s(await fetch(i(e),{method:"PATCH",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(t||{})}))}},99376:function(e,t,n){"use strict";var a=n(35475);n.o(a,"useParams")&&n.d(t,{useParams:function(){return a.useParams}}),n.o(a,"usePathname")&&n.d(t,{usePathname:function(){return a.usePathname}}),n.o(a,"useRouter")&&n.d(t,{useRouter:function(){return a.useRouter}}),n.o(a,"useSearchParams")&&n.d(t,{useSearchParams:function(){return a.useSearchParams}})}},function(e){e.O(0,[2971,2117,1744],function(){return e(e.s=42209)}),_N_E=e.O()}]);