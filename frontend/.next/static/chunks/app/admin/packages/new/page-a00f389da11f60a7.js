(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9175],{42209:function(e,t,a){Promise.resolve().then(a.bind(a,58546))},58546:function(e,t,a){"use strict";a.d(t,{default:function(){return s}});var n=a(57437),r=a(2265),c=a(99376),i=a(32617);function s(e){var t,a;let{mode:s,initialData:o}=e,u=(0,c.useRouter)(),[d,l]=(0,r.useState)({title:(null==o?void 0:o.title)||"",description:(null==o?void 0:o.description)||"",price:(null==o?void 0:o.price)||"",images:(null==o?void 0:null===(t=o.images)||void 0===t?void 0:t.join(", "))||"",featured:(null==o?void 0:o.featured)||(null==o?void 0:o.isFeatured)||!1,departments:(null==o?void 0:null===(a=o.departments)||void 0===a?void 0:a.map(e=>(null==e?void 0:e._id)||e))||[]}),[p,m]=(0,r.useState)([]);function f(e,t){l({...d,[e]:t})}async function h(e){e.preventDefault();let t={title:d.title,description:d.description,price:d.price,images:d.images.split(",").map(e=>e.trim()).filter(Boolean),featured:d.featured,departments:d.departments};try{"create"===s?await (0,i.sg)("/packages",t):await (0,i.pE)("/packages/".concat(o._id),t),u.push("/admin/packages")}catch(e){alert(e.message||"Failed")}}return(0,r.useEffect)(()=>{!async function(){try{let e=await (0,i.R1)("/departments");m((null==e?void 0:e.data)||e||[])}catch(e){console.error("Department fetch error",e)}}()},[]),(0,n.jsxs)("form",{onSubmit:h,className:"space-y-4 max-w-xl",children:[(0,n.jsx)("input",{className:"border p-2 rounded w-full",placeholder:"Title",value:d.title,onChange:e=>f("title",e.target.value),required:!0}),(0,n.jsx)("textarea",{className:"border p-2 rounded w-full h-20",placeholder:"Description",value:d.description,onChange:e=>f("description",e.target.value)}),(0,n.jsx)("input",{type:"number",className:"border p-2 rounded w-full",placeholder:"Price",value:d.price,onChange:e=>f("price",e.target.value)}),(0,n.jsx)("input",{className:"border p-2 rounded w-full",placeholder:"Image URLs (comma separated)",value:d.images,onChange:e=>f("images",e.target.value)}),(0,n.jsxs)("div",{className:"border p-3 rounded space-y-2",children:[(0,n.jsx)("p",{className:"text-sm font-medium",children:"Departments"}),(0,n.jsx)("div",{className:"flex flex-wrap gap-2",children:p.map(e=>{let t=d.departments.includes(e._id);return(0,n.jsx)("button",{type:"button",onClick:()=>{var t;return t=e._id,void l(e=>{let a=e.departments.includes(t);return{...e,departments:a?e.departments.filter(e=>e!==t):[...e.departments,t]}})},className:"px-3 py-1 rounded-full text-sm border ".concat(t?"bg-blue-100 border-blue-400 text-blue-700":"bg-gray-100 border-gray-300 text-gray-700"),children:e.name},e._id)})})]}),(0,n.jsxs)("label",{className:"flex items-center gap-2",children:[(0,n.jsx)("input",{type:"checkbox",checked:d.featured,onChange:e=>f("featured",e.target.checked)}),"Featured"]}),(0,n.jsx)("button",{type:"submit",className:"bg-blue-600 text-white px-4 py-2 rounded",children:"create"===s?"Add Package":"Update Package"})]})}},32617:function(e,t,a){"use strict";a.d(t,{QW:function(){return u},R1:function(){return i},nc:function(){return d},pE:function(){return o},sg:function(){return s}});let n="http://localhost:5000/api".replace(/\/$/,""),r="".concat(n,"/api");async function c(e){let t=await e.json().catch(()=>({}));if(!e.ok){let a=Error((null==t?void 0:t.message)||"Request failed");throw a.status=e.status,a}return t}async function i(e){return c(await fetch("".concat(r).concat(e),{method:"GET",credentials:"include"}))}async function s(e,t){let a="undefined"!=typeof FormData&&t instanceof FormData;return c(await fetch("".concat(r).concat(e),{method:"POST",credentials:"include",headers:a?void 0:{"Content-Type":"application/json"},body:a?t:JSON.stringify(t||{})}))}async function o(e,t){let a="undefined"!=typeof FormData&&t instanceof FormData;return c(await fetch("".concat(r).concat(e),{method:"PUT",credentials:"include",headers:a?void 0:{"Content-Type":"application/json"},body:a?t:JSON.stringify(t||{})}))}async function u(e){return c(await fetch("".concat(r).concat(e),{method:"DELETE",credentials:"include"}))}async function d(e,t){return c(await fetch("".concat(r).concat(e),{method:"PATCH",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(t||{})}))}},99376:function(e,t,a){"use strict";var n=a(35475);a.o(n,"useParams")&&a.d(t,{useParams:function(){return n.useParams}}),a.o(n,"usePathname")&&a.d(t,{usePathname:function(){return n.usePathname}}),a.o(n,"useRouter")&&a.d(t,{useRouter:function(){return n.useRouter}}),a.o(n,"useSearchParams")&&a.d(t,{useSearchParams:function(){return n.useSearchParams}})}},function(e){e.O(0,[2971,2117,1744],function(){return e(e.s=42209)}),_N_E=e.O()}]);