(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8758],{86108:function(e,t,a){Promise.resolve().then(a.bind(a,41586))},41586:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return x}});var l=a(57437),n=a(2265),s=a(99376),r=a(32617),i=a(87091),o=a(55375),c=a(31260);function d(e){let{label:t,options:a=[],selected:s=[],onChange:r}=e,[d,u]=(0,n.useState)(!1),p=(0,n.useRef)(null);function m(e){r&&r(s.includes(e)?s.filter(t=>t!==e):[...s,e])}(0,n.useEffect)(()=>{function e(e){p.current&&!p.current.contains(e.target)&&u(!1)}return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]);let f=a.filter(e=>s.includes(e._id));return(0,l.jsxs)("div",{className:"space-y-2",ref:p,children:[t&&(0,l.jsx)("label",{className:"text-sm text-slate-300",children:t}),(0,l.jsxs)("div",{className:"bg-slate-800 border border-slate-700 rounded-xl",children:[(0,l.jsxs)("button",{type:"button",onClick:()=>u(e=>!e),className:"w-full flex items-center justify-between px-4 py-3 text-left text-white focus:outline-none",children:[(0,l.jsx)("span",{className:"text-sm text-slate-200",children:f.length>0?"".concat(f.length," selected"):"Select departments"}),(0,l.jsx)(i.Z,{className:"h-5 w-5 text-slate-400"})]}),f.length>0&&(0,l.jsx)("div",{className:"px-3 pb-3 flex flex-wrap gap-2",children:f.map(e=>(0,l.jsxs)("span",{className:"inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs bg-teal-600/30 text-teal-100 border border-teal-500/40",children:[e.name,(0,l.jsx)("button",{type:"button",onClick:()=>m(e._id),className:"hover:text-white text-teal-200",children:(0,l.jsx)(o.Z,{className:"h-4 w-4"})})]},e._id))}),d&&(0,l.jsxs)("div",{className:"max-h-52 overflow-y-auto border-t border-slate-700 bg-slate-900 rounded-b-xl",children:[0===a.length&&(0,l.jsx)("div",{className:"px-4 py-2 text-sm text-slate-400",children:"No options available"}),a.map(e=>{let t=s.includes(e._id);return(0,l.jsxs)("button",{type:"button",onClick:()=>m(e._id),className:"w-full flex items-center justify-between px-4 py-2 text-sm ".concat(t?"bg-teal-700/30 text-white":"text-slate-200 hover:bg-slate-800"),children:[(0,l.jsx)("span",{children:e.name}),t&&(0,l.jsx)(c.Z,{className:"h-4 w-4 text-teal-300"})]},e._id)})]})]})]})}var u=a(30166);a(98527);let p=(0,u.default)(()=>Promise.all([a.e(3070),a.e(1804)]).then(a.t.bind(a,5600,23)),{loadableGenerated:{webpack:()=>[5600]},ssr:!1}),m="w-full bg-slate-800 border border-slate-700 rounded-xl px-4 py-3 text-white placeholder-slate-500 focus:outline-none focus:ring-2 focus:ring-teal-500";function f(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return e.toString().toLowerCase().trim().replace(/[^a-z0-9\s-]/g,"").replace(/\s+/g,"-")}function x(e){let{params:t}=e,a=(0,s.useRouter)(),i=(0,n.useRef)(null),o=(0,n.useRef)(null),[c,u]=(0,n.useState)([]),[x,h]=(0,n.useState)(!0),[g,b]=(0,n.useState)(""),[v,j]=(0,n.useState)(!1),[y,N]=(0,n.useState)(null),[w,C]=(0,n.useState)(""),[P,k]=(0,n.useState)([]),[D,R]=(0,n.useState)(""),[E,S]=(0,n.useState)(null),[_,O]=(0,n.useState)({name:"",price:"",duration:"",shortDescription:"",longDescription:"",included:"",departments:[],slug:""});async function L(){h(!0),b("");try{var e;let a=await (0,r.R1)("/packages/".concat(t.id,"?includeDrafts=true")),l=(null==a?void 0:a.data)||a||{};O({name:l.name||"",price:null!==(e=l.price)&&void 0!==e?e:"",duration:l.duration||"",shortDescription:l.shortDescription||"",longDescription:l.longDescription||"",included:Array.isArray(l.included)?l.included.join("\n"):l.included||"",departments:(l.departments||[]).map(e=>(null==e?void 0:e._id)||e),slug:l.slug||f(l.name||"")}),C(l.imageUrl||""),k((l.galleryImages||[]).map(e=>({url:e,file:null}))),R(l.promoVideo||""),S(null),await T()}catch(e){b("Package not found")}finally{h(!1)}}async function T(){try{let e=await (0,r.R1)("/departments?includeDrafts=true"),t=(null==e?void 0:e.data)||e||[];u(t)}catch(e){console.error("Departments load error:",e)}}function U(e){let{name:t,value:a}=e.target;if("name"===t){let e=f(a);O(t=>{let l=f(t.name||""),n=!t.slug||t.slug===l;return{...t,name:a,slug:n?e:t.slug}});return}if("slug"===t){let e=f(a);O(t=>({...t,slug:e}));return}O(e=>({...e,[t]:a}))}async function F(e){e.preventDefault(),j(!0);try{let e=_.slug&&_.slug.trim()?_.slug.trim():f(_.name||"");if(!e)throw Error("Slug is required. Please check the name.");let l=new FormData;if(l.append("name",_.name),l.append("price",_.price),l.append("duration",_.duration),l.append("shortDescription",_.shortDescription),l.append("longDescription",_.longDescription),l.append("included",_.included),l.append("slug",e),_.departments.forEach(e=>l.append("departments",e)),y?l.append("coverImage",y):w&&l.append("coverImage",w),P.filter(e=>!e.file).forEach(e=>l.append("galleryImages",e.url)),P.filter(e=>e.file).forEach(e=>l.append("galleryImages",e.file)),E?l.append("promoVideo",E):D&&l.append("promoVideo",D),!(await fetch((0,r.f8)("/packages/".concat(t.id)),{method:"PUT",body:l,credentials:"include"})).ok)throw Error("Failed to update package");a.push("/admin/packages")}catch(e){b(e.message||"Failed to update package")}finally{j(!1)}}return(0,n.useEffect)(()=>{L()},[null==t?void 0:t.id]),(0,l.jsx)("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50 px-4",children:(0,l.jsxs)("div",{className:"relative w-full max-w-4xl max-h-[90vh] bg-[#0f131a] border border-white/10 rounded-2xl shadow-2xl flex flex-col overflow-hidden",children:[(0,l.jsx)("button",{onClick:()=>a.push("/admin/packages"),className:"absolute top-4 right-4 text-gray-300 hover:text-white bg-slate-700/40 hover:bg-slate-700 rounded-full p-2 transition",children:"âœ•"}),(0,l.jsxs)("div",{className:"px-6 pt-6 pb-3 border-b border-slate-800",children:[(0,l.jsx)("h2",{className:"text-xl font-semibold text-white",children:"Edit Package"}),(0,l.jsx)("p",{className:"text-sm text-slate-400",children:"Update package details, pricing, and image."})]}),(0,l.jsxs)("form",{onSubmit:F,className:"flex-1 overflow-y-auto px-6 pb-6 pt-4 space-y-6",children:[g&&(0,l.jsx)("div",{className:"rounded-lg border border-rose-500/40 bg-rose-900/20 text-rose-200 px-4 py-3 text-sm",children:g}),x?(0,l.jsxs)("div",{className:"animate-pulse space-y-4",children:[(0,l.jsx)("div",{className:"h-10 bg-slate-800 rounded-lg"}),(0,l.jsx)("div",{className:"h-24 bg-slate-800 rounded-lg"}),(0,l.jsx)("div",{className:"h-32 bg-slate-800 rounded-lg"})]}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,l.jsxs)("div",{className:"space-y-1",children:[(0,l.jsx)("label",{className:"text-sm text-slate-300",children:"Name"}),(0,l.jsx)("input",{name:"name",value:_.name,onChange:U,className:m,required:!0})]}),(0,l.jsxs)("div",{className:"space-y-1",children:[(0,l.jsx)("label",{className:"text-sm text-slate-300",children:"Slug"}),(0,l.jsx)("input",{name:"slug",value:_.slug,onChange:U,className:m,required:!0}),(0,l.jsx)("p",{className:"text-xs text-slate-500",children:"Generated from name; you can adjust if needed."})]}),(0,l.jsxs)("div",{className:"space-y-1",children:[(0,l.jsx)("label",{className:"text-sm text-slate-300",children:"Price"}),(0,l.jsx)("input",{type:"number",name:"price",value:_.price,onChange:U,className:m,required:!0})]}),(0,l.jsxs)("div",{className:"space-y-1",children:[(0,l.jsx)("label",{className:"text-sm text-slate-300",children:"Duration"}),(0,l.jsx)("input",{name:"duration",value:_.duration,onChange:U,className:m})]}),(0,l.jsx)(d,{label:"Departments",options:c,selected:_.departments,onChange:e=>O(t=>({...t,departments:e}))})]}),(0,l.jsxs)("div",{className:"space-y-1",children:[(0,l.jsx)("label",{className:"text-sm text-slate-300",children:"Short Description"}),(0,l.jsx)("input",{name:"shortDescription",value:_.shortDescription,onChange:U,className:m})]}),(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)("label",{className:"text-sm text-slate-300",children:"Long Description"}),(0,l.jsx)("div",{className:"bg-slate-900/40 border border-slate-700 rounded-xl",children:(0,l.jsx)(p,{theme:"snow",value:_.longDescription,onChange:e=>O(t=>({...t,longDescription:e}))})})]}),(0,l.jsxs)("div",{className:"space-y-1",children:[(0,l.jsx)("label",{className:"text-sm text-slate-300",children:"Included (comma or new line)"}),(0,l.jsx)("textarea",{name:"included",value:_.included,onChange:U,rows:3,className:"".concat(m," resize-none"),placeholder:"Consultation Therapy sessions Diet plan"})]}),(0,l.jsxs)("div",{className:"border-2 border-dashed border-slate-700 bg-slate-900/40 rounded-xl p-4 flex flex-col items-center justify-center text-slate-300 cursor-pointer hover:border-teal-500 transition",onClick:()=>{var e;return null===(e=i.current)||void 0===e?void 0:e.click()},onDragOver:e=>e.preventDefault(),onDrop:function(e){var t;e.preventDefault();let a=null===(t=e.dataTransfer.files)||void 0===t?void 0:t[0];a&&(N(a),C(URL.createObjectURL(a)))},children:[(0,l.jsx)("input",{type:"file",accept:"image/*",ref:i,className:"hidden",onChange:function(e){var t;let a=null===(t=e.target.files)||void 0===t?void 0:t[0];a&&(N(a),C(URL.createObjectURL(a)))}}),w?(0,l.jsx)("img",{src:w,alt:"Preview",className:"w-full max-w-xs h-32 object-cover rounded-lg border border-slate-700"}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("p",{className:"font-medium",children:"Cover image"}),(0,l.jsx)("p",{className:"text-xs text-slate-500",children:"Click or drop PNG/JPG"})]})]}),(0,l.jsxs)("div",{className:"space-y-2 border border-slate-700 bg-slate-900/40 rounded-xl p-4",children:[(0,l.jsx)("label",{className:"text-sm text-slate-300",children:"Promo video"}),(0,l.jsx)("input",{value:E?"":D,onChange:e=>{R(e.target.value),S(null)},placeholder:"Paste video URL",className:m}),(0,l.jsx)("input",{type:"file",accept:"video/*",onChange:function(e){var t;let a=null===(t=e.target.files)||void 0===t?void 0:t[0];a&&(S(a),R(""))},className:"text-sm text-slate-300"}),E&&(0,l.jsx)("p",{className:"text-xs text-teal-300",children:"Video file ready to upload"})]}),(0,l.jsxs)("div",{className:"space-y-2 md:col-span-2",children:[(0,l.jsx)("label",{className:"text-sm text-slate-300",children:"Gallery images"}),(0,l.jsxs)("label",{className:"border-2 border-dashed border-slate-700 bg-slate-900/40 rounded-xl p-4 flex flex-col items-center justify-center text-slate-300 cursor-pointer hover:border-teal-500 transition",children:[(0,l.jsx)("input",{ref:o,type:"file",accept:"image/*",multiple:!0,onChange:function(e){let t=Array.from(e.target.files||[]);t.length&&k(e=>[...e,...t.map(e=>({url:URL.createObjectURL(e),file:e}))])},className:"hidden"}),(0,l.jsx)("span",{className:"font-medium",children:"Click to upload or drop files"}),(0,l.jsx)("span",{className:"text-xs text-slate-500",children:"PNG/JPG"})]}),(0,l.jsx)("div",{className:"flex flex-wrap gap-2",children:P.map((e,t)=>(0,l.jsxs)("div",{className:"relative h-20 w-20 rounded-lg overflow-hidden border border-slate-700",children:[(0,l.jsx)("img",{src:e.url,className:"h-full w-full object-cover"}),(0,l.jsx)("button",{type:"button",onClick:()=>{k(e=>e.filter((e,a)=>a!==t))},className:"absolute top-1 right-1 bg-black/70 text-white rounded-full text-xs px-1",children:"\xd7"})]},t))})]})]})]}),(0,l.jsxs)("div",{className:"mt-auto border-t border-slate-800 bg-[#0b1017] px-6 py-4 flex justify-end gap-3",children:[(0,l.jsx)("button",{type:"button",onClick:()=>a.push("/admin/packages"),className:"px-4 py-2 rounded-lg bg-slate-800 text-white hover:bg-slate-700 transition",children:"Cancel"}),(0,l.jsx)("button",{type:"submit",onClick:F,disabled:v||x,className:"px-4 py-2 rounded-lg bg-teal-600 text-white hover:bg-teal-500 transition disabled:opacity-70",children:v?"Updating...":"Update"})]})]})})}},32617:function(e,t,a){"use strict";a.d(t,{QW:function(){return d},R1:function(){return i},f8:function(){return s},nc:function(){return u},pE:function(){return c},sg:function(){return o}});let l="http://localhost:5000/api".replace(/\/$/,""),n=l.endsWith("/api")?l:"".concat(l,"/api");function s(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=e.startsWith("/")?e:"/".concat(e),a="".concat(n).concat(t);return console.log("[api] request url:",a),a}async function r(e){let t=await e.json().catch(()=>({}));if(!e.ok){let a=Error((null==t?void 0:t.message)||"Request failed");throw a.status=e.status,a}return t}async function i(e){return r(await fetch(s(e),{method:"GET",credentials:"include"}))}async function o(e,t){let a="undefined"!=typeof FormData&&t instanceof FormData;return r(await fetch(s(e),{method:"POST",credentials:"include",headers:a?void 0:{"Content-Type":"application/json"},body:a?t:JSON.stringify(t||{})}))}async function c(e,t){let a="undefined"!=typeof FormData&&t instanceof FormData;return r(await fetch(s(e),{method:"PUT",credentials:"include",headers:a?void 0:{"Content-Type":"application/json"},body:a?t:JSON.stringify(t||{})}))}async function d(e){return r(await fetch(s(e),{method:"DELETE",credentials:"include"}))}async function u(e,t){return r(await fetch(s(e),{method:"PATCH",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(t||{})}))}},30166:function(e,t,a){"use strict";a.d(t,{default:function(){return n.a}});var l=a(55775),n=a.n(l)},99376:function(e,t,a){"use strict";var l=a(35475);a.o(l,"useParams")&&a.d(t,{useParams:function(){return l.useParams}}),a.o(l,"usePathname")&&a.d(t,{usePathname:function(){return l.usePathname}}),a.o(l,"useRouter")&&a.d(t,{useRouter:function(){return l.useRouter}}),a.o(l,"useSearchParams")&&a.d(t,{useSearchParams:function(){return l.useSearchParams}})},55775:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return s}});let l=a(60917);a(57437),a(2265);let n=l._(a(15602));function s(e,t){var a;let l={loading:e=>{let{error:t,isLoading:a,pastDelay:l}=e;return null}};"function"==typeof e&&(l.loader=e);let s={...l,...t};return(0,n.default)({...s,modules:null==(a=s.loadableGenerated)?void 0:a.modules})}("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},81523:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"BailoutToCSR",{enumerable:!0,get:function(){return n}});let l=a(18993);function n(e){let{reason:t,children:a}=e;if("undefined"==typeof window)throw new l.BailoutToCSRError(t);return a}},15602:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return c}});let l=a(57437),n=a(2265),s=a(81523),r=a(70049);function i(e){return{default:e&&"default"in e?e.default:e}}let o={loader:()=>Promise.resolve(i(()=>null)),loading:null,ssr:!0},c=function(e){let t={...o,...e},a=(0,n.lazy)(()=>t.loader().then(i)),c=t.loading;function d(e){let i=c?(0,l.jsx)(c,{isLoading:!0,pastDelay:!0,error:null}):null,o=t.ssr?(0,l.jsxs)(l.Fragment,{children:["undefined"==typeof window?(0,l.jsx)(r.PreloadCss,{moduleIds:t.modules}):null,(0,l.jsx)(a,{...e})]}):(0,l.jsx)(s.BailoutToCSR,{reason:"next/dynamic",children:(0,l.jsx)(a,{...e})});return(0,l.jsx)(n.Suspense,{fallback:i,children:o})}return d.displayName="LoadableComponent",d}},70049:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"PreloadCss",{enumerable:!0,get:function(){return s}});let l=a(57437),n=a(20544);function s(e){let{moduleIds:t}=e;if("undefined"!=typeof window)return null;let a=(0,n.getExpectedRequestStore)("next/dynamic css"),s=[];if(a.reactLoadableManifest&&t){let e=a.reactLoadableManifest;for(let a of t){if(!e[a])continue;let t=e[a].files.filter(e=>e.endsWith(".css"));s.push(...t)}}return 0===s.length?null:(0,l.jsx)(l.Fragment,{children:s.map(e=>(0,l.jsx)("link",{precedence:"dynamic",rel:"stylesheet",href:a.assetPrefix+"/_next/"+encodeURI(e),as:"style"},e))})}},98527:function(){},31260:function(e,t,a){"use strict";var l=a(2265);let n=l.forwardRef(function(e,t){let{title:a,titleId:n,...s}=e;return l.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":n},s),a?l.createElement("title",{id:n},a):null,l.createElement("path",{fillRule:"evenodd",d:"M19.916 4.626a.75.75 0 0 1 .208 1.04l-9 13.5a.75.75 0 0 1-1.154.114l-6-6a.75.75 0 0 1 1.06-1.06l5.353 5.353 8.493-12.74a.75.75 0 0 1 1.04-.207Z",clipRule:"evenodd"}))});t.Z=n},87091:function(e,t,a){"use strict";var l=a(2265);let n=l.forwardRef(function(e,t){let{title:a,titleId:n,...s}=e;return l.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":n},s),a?l.createElement("title",{id:n},a):null,l.createElement("path",{fillRule:"evenodd",d:"M11.47 4.72a.75.75 0 0 1 1.06 0l3.75 3.75a.75.75 0 0 1-1.06 1.06L12 6.31 8.78 9.53a.75.75 0 0 1-1.06-1.06l3.75-3.75Zm-3.75 9.75a.75.75 0 0 1 1.06 0L12 17.69l3.22-3.22a.75.75 0 1 1 1.06 1.06l-3.75 3.75a.75.75 0 0 1-1.06 0l-3.75-3.75a.75.75 0 0 1 0-1.06Z",clipRule:"evenodd"}))});t.Z=n},55375:function(e,t,a){"use strict";var l=a(2265);let n=l.forwardRef(function(e,t){let{title:a,titleId:n,...s}=e;return l.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":n},s),a?l.createElement("title",{id:n},a):null,l.createElement("path",{fillRule:"evenodd",d:"M5.47 5.47a.75.75 0 0 1 1.06 0L12 10.94l5.47-5.47a.75.75 0 1 1 1.06 1.06L13.06 12l5.47 5.47a.75.75 0 1 1-1.06 1.06L12 13.06l-5.47 5.47a.75.75 0 0 1-1.06-1.06L10.94 12 5.47 6.53a.75.75 0 0 1 0-1.06Z",clipRule:"evenodd"}))});t.Z=n}},function(e){e.O(0,[6458,2971,2117,1744],function(){return e(e.s=86108)}),_N_E=e.O()}]);