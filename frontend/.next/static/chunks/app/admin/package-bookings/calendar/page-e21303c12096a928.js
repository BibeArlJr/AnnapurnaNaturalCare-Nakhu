(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8481],{98869:function(e,t,n){Promise.resolve().then(n.bind(n,35811))},35811:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return u}});var r=n(57437),s=n(2265),a=n(71096),i=n.n(a),o=n(98197),l=n(32617);let c=e=>{let t={pending:"bg-yellow-600/30 text-yellow-300 border-yellow-600",confirmed:"bg-teal-600/30 text-teal-300 border-teal-600",cancelled:"bg-rose-600/30 text-rose-300 border-rose-600",completed:"bg-blue-600/30 text-blue-300 border-blue-600",rescheduled:"bg-blue-600/30 text-blue-300 border-blue-600"},n=t[e]||t.pending,s=(e||"pending").charAt(0).toUpperCase()+(e||"pending").slice(1);return(0,r.jsx)("span",{className:"text-xs px-2 py-0.5 rounded-full border inline-block ".concat(n),children:s})};function u(){let[e,t]=(0,s.useState)([]),[n,a]=(0,s.useState)([]),[u,d]=(0,s.useState)(null),[f,h]=(0,s.useState)({status:"pending",preferredStartDate:"",peopleCount:1,notes:"",adminMessage:""});function p(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:n,r=t.find(t=>t._id===e);if(!r)return 1;let s=Number(r.duration);return s>0?s:1}async function m(){try{let[e,n]=await Promise.all([(0,l.R1)("/package-bookings"),(0,l.R1)("/packages")]),r=(null==e?void 0:e.data)||e||[],s=(null==n?void 0:n.data)||n||[];a(s);let o=r.filter(e=>e.preferredStartDate).map(e=>{let t=i()(e.preferredStartDate).format("YYYY-MM-DD"),n=p(e.packageId,s);return{id:e._id,title:"".concat(e.userName||e.name||"Customer"," – ").concat(e.packageName||"Package").concat(n>1?" (".concat(n,"d)"):""),start:t,allDay:!0,extendedProps:{...e,status:e.status,duration:n}}});t(o)}catch(e){console.error("Package booking calendar load error:",e)}}function x(e,t){d(e),h({status:t||e.status||"pending",preferredStartDate:e.preferredStartDate||"",peopleCount:e.peopleCount||1,notes:e.notes||"",adminMessage:""})}async function g(){if(null==u?void 0:u._id){if("cancelled"===f.status&&!f.adminMessage.trim()){alert("Cancellation reason is required");return}if("rescheduled"===f.status&&!f.preferredStartDate){alert("Please select a new start date for reschedule");return}try{await (0,l.nc)("/package-bookings/".concat(u._id,"/status"),{status:f.status,preferredStartDate:f.preferredStartDate,peopleCount:f.peopleCount,notes:f.notes,adminMessage:f.adminMessage.trim()}),d(null),m()}catch(e){alert((null==e?void 0:e.message)||"Failed to update booking")}}}return(0,s.useEffect)(()=>{m()},[]),(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-2xl font-semibold text-white",children:"Package Bookings Calendar"}),(0,r.jsx)("p",{className:"text-slate-400 text-sm",children:"View package bookings on the calendar."})]}),(0,r.jsx)(o.Z,{events:e,onDateSelect:()=>{},onEventClick:e=>{d(e.event.extendedProps),x(e.event.extendedProps)}}),u&&(0,r.jsx)("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-start justify-center z-50 px-4 py-8 overflow-y-auto",children:(0,r.jsxs)("div",{className:"bg-[#0f131a] border border-white/10 rounded-2xl p-6 space-y-4 text-white w-full max-w-xl max-h-[90vh] flex flex-col overflow-hidden",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between flex-shrink-0",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm text-slate-400",children:"Package Booking"}),(0,r.jsxs)("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[u.userName||u.name||"Customer"," ",c(u.status)]}),(0,r.jsx)("p",{className:"text-slate-300 text-sm",children:u.packageName||"Package"})]}),(0,r.jsx)("button",{onClick:()=>d(null),"aria-label":"Close",children:"✕"})]}),(0,r.jsxs)("div",{className:"space-y-2 text-sm text-slate-300",children:[(0,r.jsxs)("p",{children:[(0,r.jsx)("span",{className:"text-slate-400",children:"Preferred start:"})," ",u.preferredStartDate?i()(u.preferredStartDate).format("MMM D, YYYY"):"—"]}),(0,r.jsxs)("p",{children:[(0,r.jsx)("span",{className:"text-slate-400",children:"Duration:"})," ",u.duration||p(u.packageId)," ","days"]}),(0,r.jsxs)("p",{children:[(0,r.jsx)("span",{className:"text-slate-400",children:"People:"})," ",u.peopleCount||1]}),(0,r.jsxs)("p",{children:[(0,r.jsx)("span",{className:"text-slate-400",children:"Email:"})," ",u.email||"No email"]}),(0,r.jsxs)("p",{children:[(0,r.jsx)("span",{className:"text-slate-400",children:"Phone:"})," ",u.phone||"—"]}),(u.createdBy||u.source)&&(0,r.jsxs)("p",{children:[(0,r.jsx)("span",{className:"text-slate-400",children:"Created via:"})," ","admin"===u.createdBy?"Admin":"Website",u.source?" • ".concat(u.source):""]}),u.notes&&(0,r.jsxs)("p",{children:[(0,r.jsx)("span",{className:"text-slate-400",children:"Notes:"})," ",u.notes]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 flex-1 overflow-y-auto min-h-0",children:[(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsx)("label",{className:"text-sm text-slate-300",children:"Status"}),(0,r.jsx)("select",{value:f.status,onChange:e=>h(t=>({...t,status:e.target.value})),className:"w-full bg-slate-800 border border-slate-700 rounded-xl px-4 py-3 text-white focus:outline-none focus:ring-2 focus:ring-teal-500",children:["pending","confirmed","rescheduled","cancelled"].map(e=>(0,r.jsx)("option",{value:e,children:e},e))})]}),(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsx)("label",{className:"text-sm text-slate-300",children:"Preferred Start Date"}),(0,r.jsx)("input",{type:"date",value:f.preferredStartDate,onChange:e=>h(t=>({...t,preferredStartDate:e.target.value})),className:"w-full bg-slate-800 border border-slate-700 rounded-xl px-4 py-3 text-white focus:outline-none focus:ring-2 focus:ring-teal-500"})]}),(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsx)("label",{className:"text-sm text-slate-300",children:"Number of People"}),(0,r.jsx)("input",{type:"number",min:1,value:f.peopleCount,onChange:e=>h(t=>({...t,peopleCount:e.target.value})),className:"w-full bg-slate-800 border border-slate-700 rounded-xl px-4 py-3 text-white focus:outline-none focus:ring-2 focus:ring-teal-500"})]}),(0,r.jsxs)("div",{className:"space-y-1 md:col-span-2",children:[(0,r.jsx)("label",{className:"text-sm text-slate-300",children:"Message to customer (required for cancel/reschedule)"}),(0,r.jsx)("textarea",{rows:3,value:f.adminMessage,onChange:e=>h(t=>({...t,adminMessage:e.target.value})),className:"w-full bg-slate-800 border border-slate-700 rounded-xl px-4 py-3 text-white focus:outline-none focus:ring-2 focus:ring-teal-500 resize-none",placeholder:"Notes for customer"})]}),(0,r.jsxs)("div",{className:"space-y-1 md:col-span-2",children:[(0,r.jsx)("label",{className:"text-sm text-slate-300",children:"Internal Notes"}),(0,r.jsx)("textarea",{rows:3,value:f.notes,onChange:e=>h(t=>({...t,notes:e.target.value})),className:"w-full bg-slate-800 border border-slate-700 rounded-xl px-4 py-3 text-white focus:outline-none focus:ring-2 focus:ring-teal-500 resize-none",placeholder:"Admin-only notes"})]})]}),(0,r.jsxs)("div",{className:"flex justify-end gap-3 flex-shrink-0",children:[(0,r.jsx)("button",{onClick:()=>d(null),className:"px-4 py-2 rounded-lg bg-slate-800 hover:bg-slate-700 text-white",children:"Close"}),(0,r.jsx)("button",{onClick:()=>x(u,"rescheduled"),className:"px-4 py-2 rounded-lg bg-blue-600 hover:bg-blue-500 text-white",children:"Reschedule"}),(0,r.jsx)("button",{onClick:()=>x(u,"cancelled"),className:"px-4 py-2 rounded-lg bg-rose-600 hover:bg-rose-500 text-white",children:"Cancel"}),(0,r.jsx)("button",{onClick:g,className:"px-4 py-2 rounded-lg bg-teal-600 hover:bg-teal-500 text-white",children:"Save Changes"})]})]})})]})}},98197:function(e,t,n){"use strict";n.d(t,{Z:function(){return l}});var r=n(57437),s=n(2265),a=n(85262),i=n(48185),o=n(62516);function l(e){let{events:t,onDateSelect:n,onEventClick:l}=e,c=(0,s.useRef)(null),u=e=>{switch(e){case"cancelled":return"bg-[#7f2d38] border-[#b55460] text-white";case"confirmed":return"bg-[#0d5047] border-[#31b8a4] text-white";case"pending":return"bg-[#725d27] border-[#d1b84a] text-white";case"completed":case"rescheduled":return"bg-[#234d7f] border-[#4b8fd1] text-white";default:return"bg-[#2a2e35] border-[#3b3f46] text-white"}};return(0,s.useEffect)(()=>()=>{var e,t;let n=null===(t=c.current)||void 0===t?void 0:null===(e=t.getApi)||void 0===e?void 0:e.call(t);null==n||n.destroy()},[]),(0,r.jsx)("div",{className:"border border-white/5 bg-[#0e1217] rounded-xl p-4",children:(0,r.jsx)(a.Z,{ref:c,plugins:[i.Z,o.ZP],initialView:"dayGridMonth",height:650,events:t,dateClick:e=>n(e.dateStr),eventClick:e=>null==l?void 0:l(e),eventContent:e=>({html:'<span class="truncate block">'.concat(e.event.title,"</span>")}),eventClassNames:e=>{var t;return"px-2 py-1 rounded-md text-xs truncate border cursor-pointer ".concat(u(null===(t=e.event.extendedProps)||void 0===t?void 0:t.status))}})})}n(32972)},32617:function(e,t,n){"use strict";n.d(t,{QW:function(){return u},R1:function(){return o},f8:function(){return a},nc:function(){return d},pE:function(){return c},sg:function(){return l}});let r="http://localhost:5000/api".replace(/\/$/,""),s=r.endsWith("/api")?r:"".concat(r,"/api");function a(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=e.startsWith("/")?e:"/".concat(e),n="".concat(s).concat(t);return console.log("[api] request url:",n),n}async function i(e){let t=await e.json().catch(()=>({}));if(!e.ok){let n=Error((null==t?void 0:t.message)||"Request failed");throw n.status=e.status,n}return t}async function o(e){return i(await fetch(a(e),{method:"GET",credentials:"include"}))}async function l(e,t){let n="undefined"!=typeof FormData&&t instanceof FormData;return i(await fetch(a(e),{method:"POST",credentials:"include",headers:n?void 0:{"Content-Type":"application/json"},body:n?t:JSON.stringify(t||{})}))}async function c(e,t){let n="undefined"!=typeof FormData&&t instanceof FormData;return i(await fetch(a(e),{method:"PUT",credentials:"include",headers:n?void 0:{"Content-Type":"application/json"},body:n?t:JSON.stringify(t||{})}))}async function u(e){return i(await fetch(a(e),{method:"DELETE",credentials:"include"}))}async function d(e,t){return i(await fetch(a(e),{method:"PATCH",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(t||{})}))}},71096:function(e){var t;t=function(){"use strict";var e="millisecond",t="second",n="minute",r="hour",s="week",a="month",i="quarter",o="year",l="date",c="Invalid Date",u=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,d=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,f=function(e,t,n){var r=String(e);return!r||r.length>=t?e:""+Array(t+1-r.length).join(n)+e},h="en",p={};p[h]={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(e){var t=["th","st","nd","rd"],n=e%100;return"["+e+(t[(n-20)%10]||t[n]||"th")+"]"}};var m="$isDayjsObject",x=function(e){return e instanceof y||!(!e||!e[m])},g=function e(t,n,r){var s;if(!t)return h;if("string"==typeof t){var a=t.toLowerCase();p[a]&&(s=a),n&&(p[a]=n,s=a);var i=t.split("-");if(!s&&i.length>1)return e(i[0])}else{var o=t.name;p[o]=t,s=o}return!r&&s&&(h=s),s||!r&&h},b=function(e,t){if(x(e))return e.clone();var n="object"==typeof t?t:{};return n.date=e,n.args=arguments,new y(n)},v={s:f,z:function(e){var t=-e.utcOffset(),n=Math.abs(t);return(t<=0?"+":"-")+f(Math.floor(n/60),2,"0")+":"+f(n%60,2,"0")},m:function e(t,n){if(t.date()<n.date())return-e(n,t);var r=12*(n.year()-t.year())+(n.month()-t.month()),s=t.clone().add(r,a),i=n-s<0,o=t.clone().add(r+(i?-1:1),a);return+(-(r+(n-s)/(i?s-o:o-s))||0)},a:function(e){return e<0?Math.ceil(e)||0:Math.floor(e)},p:function(c){return({M:a,y:o,w:s,d:"day",D:l,h:r,m:n,s:t,ms:e,Q:i})[c]||String(c||"").toLowerCase().replace(/s$/,"")},u:function(e){return void 0===e}};v.l=g,v.i=x,v.w=function(e,t){return b(e,{locale:t.$L,utc:t.$u,x:t.$x,$offset:t.$offset})};var y=function(){function f(e){this.$L=g(e.locale,null,!0),this.parse(e),this.$x=this.$x||e.x||{},this[m]=!0}var h=f.prototype;return h.parse=function(e){this.$d=function(e){var t=e.date,n=e.utc;if(null===t)return new Date(NaN);if(v.u(t))return new Date;if(t instanceof Date)return new Date(t);if("string"==typeof t&&!/Z$/i.test(t)){var r=t.match(u);if(r){var s=r[2]-1||0,a=(r[7]||"0").substring(0,3);return n?new Date(Date.UTC(r[1],s,r[3]||1,r[4]||0,r[5]||0,r[6]||0,a)):new Date(r[1],s,r[3]||1,r[4]||0,r[5]||0,r[6]||0,a)}}return new Date(t)}(e),this.init()},h.init=function(){var e=this.$d;this.$y=e.getFullYear(),this.$M=e.getMonth(),this.$D=e.getDate(),this.$W=e.getDay(),this.$H=e.getHours(),this.$m=e.getMinutes(),this.$s=e.getSeconds(),this.$ms=e.getMilliseconds()},h.$utils=function(){return v},h.isValid=function(){return this.$d.toString()!==c},h.isSame=function(e,t){var n=b(e);return this.startOf(t)<=n&&n<=this.endOf(t)},h.isAfter=function(e,t){return b(e)<this.startOf(t)},h.isBefore=function(e,t){return this.endOf(t)<b(e)},h.$g=function(e,t,n){return v.u(e)?this[t]:this.set(n,e)},h.unix=function(){return Math.floor(this.valueOf()/1e3)},h.valueOf=function(){return this.$d.getTime()},h.startOf=function(e,i){var c=this,u=!!v.u(i)||i,d=v.p(e),f=function(e,t){var n=v.w(c.$u?Date.UTC(c.$y,t,e):new Date(c.$y,t,e),c);return u?n:n.endOf("day")},h=function(e,t){return v.w(c.toDate()[e].apply(c.toDate("s"),(u?[0,0,0,0]:[23,59,59,999]).slice(t)),c)},p=this.$W,m=this.$M,x=this.$D,g="set"+(this.$u?"UTC":"");switch(d){case o:return u?f(1,0):f(31,11);case a:return u?f(1,m):f(0,m+1);case s:var b=this.$locale().weekStart||0,y=(p<b?p+7:p)-b;return f(u?x-y:x+(6-y),m);case"day":case l:return h(g+"Hours",0);case r:return h(g+"Minutes",1);case n:return h(g+"Seconds",2);case t:return h(g+"Milliseconds",3);default:return this.clone()}},h.endOf=function(e){return this.startOf(e,!1)},h.$set=function(s,i){var c,u=v.p(s),d="set"+(this.$u?"UTC":""),f=((c={}).day=d+"Date",c[l]=d+"Date",c[a]=d+"Month",c[o]=d+"FullYear",c[r]=d+"Hours",c[n]=d+"Minutes",c[t]=d+"Seconds",c[e]=d+"Milliseconds",c)[u],h="day"===u?this.$D+(i-this.$W):i;if(u===a||u===o){var p=this.clone().set(l,1);p.$d[f](h),p.init(),this.$d=p.set(l,Math.min(this.$D,p.daysInMonth())).$d}else f&&this.$d[f](h);return this.init(),this},h.set=function(e,t){return this.clone().$set(e,t)},h.get=function(e){return this[v.p(e)]()},h.add=function(e,i){var l,c=this;e=Number(e);var u=v.p(i),d=function(t){var n=b(c);return v.w(n.date(n.date()+Math.round(t*e)),c)};if(u===a)return this.set(a,this.$M+e);if(u===o)return this.set(o,this.$y+e);if("day"===u)return d(1);if(u===s)return d(7);var f=((l={})[n]=6e4,l[r]=36e5,l[t]=1e3,l)[u]||1,h=this.$d.getTime()+e*f;return v.w(h,this)},h.subtract=function(e,t){return this.add(-1*e,t)},h.format=function(e){var t=this,n=this.$locale();if(!this.isValid())return n.invalidDate||c;var r=e||"YYYY-MM-DDTHH:mm:ssZ",s=v.z(this),a=this.$H,i=this.$m,o=this.$M,l=n.weekdays,u=n.months,f=n.meridiem,h=function(e,n,s,a){return e&&(e[n]||e(t,r))||s[n].slice(0,a)},p=function(e){return v.s(a%12||12,e,"0")},m=f||function(e,t,n){var r=e<12?"AM":"PM";return n?r.toLowerCase():r};return r.replace(d,function(e,r){return r||function(e){switch(e){case"YY":return String(t.$y).slice(-2);case"YYYY":return v.s(t.$y,4,"0");case"M":return o+1;case"MM":return v.s(o+1,2,"0");case"MMM":return h(n.monthsShort,o,u,3);case"MMMM":return h(u,o);case"D":return t.$D;case"DD":return v.s(t.$D,2,"0");case"d":return String(t.$W);case"dd":return h(n.weekdaysMin,t.$W,l,2);case"ddd":return h(n.weekdaysShort,t.$W,l,3);case"dddd":return l[t.$W];case"H":return String(a);case"HH":return v.s(a,2,"0");case"h":return p(1);case"hh":return p(2);case"a":return m(a,i,!0);case"A":return m(a,i,!1);case"m":return String(i);case"mm":return v.s(i,2,"0");case"s":return String(t.$s);case"ss":return v.s(t.$s,2,"0");case"SSS":return v.s(t.$ms,3,"0");case"Z":return s}return null}(e)||s.replace(":","")})},h.utcOffset=function(){return-(15*Math.round(this.$d.getTimezoneOffset()/15))},h.diff=function(e,l,c){var u,d=this,f=v.p(l),h=b(e),p=(h.utcOffset()-this.utcOffset())*6e4,m=this-h,x=function(){return v.m(d,h)};switch(f){case o:u=x()/12;break;case a:u=x();break;case i:u=x()/3;break;case s:u=(m-p)/6048e5;break;case"day":u=(m-p)/864e5;break;case r:u=m/36e5;break;case n:u=m/6e4;break;case t:u=m/1e3;break;default:u=m}return c?u:v.a(u)},h.daysInMonth=function(){return this.endOf(a).$D},h.$locale=function(){return p[this.$L]},h.locale=function(e,t){if(!e)return this.$L;var n=this.clone(),r=g(e,t,!0);return r&&(n.$L=r),n},h.clone=function(){return v.w(this.$d,this)},h.toDate=function(){return new Date(this.valueOf())},h.toJSON=function(){return this.isValid()?this.toISOString():null},h.toISOString=function(){return this.$d.toISOString()},h.toString=function(){return this.$d.toUTCString()},f}(),$=y.prototype;return b.prototype=$,[["$ms",e],["$s",t],["$m",n],["$H",r],["$W","day"],["$M",a],["$y",o],["$D",l]].forEach(function(e){$[e[1]]=function(t){return this.$g(t,e[0],e[1])}}),b.extend=function(e,t){return e.$i||(e(t,y,b),e.$i=!0),b},b.locale=g,b.isDayjs=x,b.unix=function(e){return b(1e3*e)},b.en=p[h],b.Ls=p,b.p={},b},e.exports=t()},32972:function(){}},function(e){e.O(0,[9021,8554,4157,2971,2117,1744],function(){return e(e.s=98869)}),_N_E=e.O()}]);