(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5687],{49791:function(e,t,a){Promise.resolve().then(a.bind(a,54931))},54931:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return r}});var s=a(57437),n=a(2265),l=a(32617),i=a(27648);function r(){let[e,t]=(0,n.useState)([]),[a,r]=(0,n.useState)(!0),[c,d]=(0,n.useState)(""),[o,u]=(0,n.useState)(null),h=async()=>{r(!0);try{let e=await (0,l.R1)("/patient-reviews?status=all&includeDrafts=true");t((null==e?void 0:e.data)||e||[]),d("")}catch(e){d("Failed to load reviews"),t([])}finally{r(!1)}};(0,n.useEffect)(()=>{h()},[]);let x=async e=>{window.confirm("Delete this review?")&&(await (0,l.QW)("/patient-reviews/".concat(e)),await h())},f=async e=>{let a="published"===e.status?"draft":"published";u(e._id),t(t=>t.map(t=>t._id===e._id?{...t,status:a,publishedAt:"published"===a?new Date().toISOString():t.publishedAt}:t));try{await (0,l.nc)("/patient-reviews/".concat(e._id),{status:a,publishedAt:"published"===a?new Date:void 0})}catch(a){t(t=>t.map(t=>t._id===e._id?{...t,status:e.status,publishedAt:e.publishedAt}:t)),alert("Failed to update status")}finally{u(null)}},m=e=>{if(!e)return"—";try{return new Date(e).toLocaleDateString()}catch(e){return"—"}},p=(0,n.useMemo)(()=>e=>{if(!e)return"";let t=e.toString().replace(/<[^>]+>/g," ").replace(/\s+/g," ").trim();return t.length>140?"".concat(t.slice(0,137),"..."):t},[]),b=e=>{let{status:t}=e,a="published"===t;return(0,s.jsx)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-semibold ".concat(a?"bg-emerald-600/20 text-emerald-200 border border-emerald-500/40":"bg-slate-700/60 text-slate-200 border border-slate-600"),children:a?"Published":"Draft"})},g=e=>{let{item:t}=e;return(0,s.jsx)("button",{onClick:()=>f(t),disabled:o===t._id,className:"relative inline-flex h-7 w-12 items-center rounded-full border ".concat("published"===t.status?"bg-emerald-600/30 border-emerald-400":"bg-slate-700 border-slate-500"," transition"),"aria-label":"Toggle publish",children:(0,s.jsx)("span",{className:"absolute left-1 h-5 w-5 rounded-full bg-white transition-transform ".concat("published"===t.status?"translate-x-5":"translate-x-0")})})};return(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-2xl font-semibold text-white",children:"Patient Reviews"}),(0,s.jsx)("p",{className:"text-sm text-slate-400",children:"Manage patient testimonials."})]}),(0,s.jsx)(i.default,{href:"/admin/reviews/new",className:"px-4 py-2 rounded-lg bg-teal-600 text-white text-sm hover:bg-teal-500",children:"Add review"})]}),a?(0,s.jsx)("p",{className:"text-slate-400",children:"Loading..."}):c?(0,s.jsx)("p",{className:"text-red-400",children:c}):0===e.length?(0,s.jsx)("p",{className:"text-slate-400",children:"No reviews yet."}):(0,s.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-3 gap-4",children:e.map(e=>(0,s.jsxs)("div",{className:"bg-[#0f131a] border border-slate-800 rounded-xl shadow-lg overflow-hidden flex flex-col",children:[(0,s.jsxs)("div",{className:"relative h-40 bg-slate-900",children:[e.coverImage||e.photo?(0,s.jsx)("img",{src:e.coverImage||e.photo,alt:e.patientName,className:"w-full h-full object-cover"}):(0,s.jsx)("div",{className:"w-full h-full bg-gradient-to-br from-slate-800 to-slate-900"}),(0,s.jsx)("div",{className:"absolute top-2 left-2 flex items-center gap-2",children:(0,s.jsx)(b,{status:e.status})})]}),(0,s.jsxs)("div",{className:"p-4 flex flex-col gap-3 flex-1",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-semibold text-white",children:e.patientName}),e.country?(0,s.jsx)("p",{className:"text-xs text-slate-400",children:e.country}):null]}),(0,s.jsx)(g,{item:e})]}),(0,s.jsx)("p",{className:"text-base font-semibold text-white line-clamp-2",children:e.headline}),(0,s.jsxs)("div",{className:"text-xs text-slate-400 flex items-center gap-2",children:[e.rating?(0,s.jsx)("span",{className:"text-amber-400",children:"".concat(e.rating,"/5")}):(0,s.jsx)("span",{className:"text-slate-600",children:"No rating"}),(0,s.jsxs)("span",{children:["• Created ",m(e.createdAt)]}),e.updatedAt?(0,s.jsxs)("span",{children:["• Updated ",m(e.updatedAt)]}):null]}),e.fullReview?(0,s.jsx)("p",{className:"text-sm text-slate-300 line-clamp-3",children:p(e.fullReview)}):null,(0,s.jsxs)("div",{className:"flex gap-2 pt-2",children:[(0,s.jsx)(i.default,{href:"/admin/reviews/".concat(e._id),className:"px-3 py-2 text-xs rounded bg-slate-800 text-white hover:bg-slate-700 border border-slate-700",children:"Edit"}),(0,s.jsx)("button",{onClick:()=>x(e._id),className:"px-3 py-2 text-xs rounded bg-rose-900/40 text-rose-200 hover:bg-rose-800/60 border border-rose-700/60",children:"Delete"}),e.slug?(0,s.jsx)(i.default,{href:"/patient-reviews/".concat(e.slug),className:"px-3 py-2 text-xs rounded bg-emerald-900/40 text-emerald-200 hover:bg-emerald-800/60 border border-emerald-700/60",children:"View"}):null]})]})]},e._id))})]})}},32617:function(e,t,a){"use strict";a.d(t,{QW:function(){return d},R1:function(){return i},nc:function(){return o},pE:function(){return c},sg:function(){return r}});let s="http://localhost:5000/api".replace(/\/$/,""),n="".concat(s,"/api");async function l(e){let t=await e.json().catch(()=>({}));if(!e.ok){let a=Error((null==t?void 0:t.message)||"Request failed");throw a.status=e.status,a}return t}async function i(e){return l(await fetch("".concat(n).concat(e),{method:"GET",credentials:"include"}))}async function r(e,t){let a="undefined"!=typeof FormData&&t instanceof FormData;return l(await fetch("".concat(n).concat(e),{method:"POST",credentials:"include",headers:a?void 0:{"Content-Type":"application/json"},body:a?t:JSON.stringify(t||{})}))}async function c(e,t){let a="undefined"!=typeof FormData&&t instanceof FormData;return l(await fetch("".concat(n).concat(e),{method:"PUT",credentials:"include",headers:a?void 0:{"Content-Type":"application/json"},body:a?t:JSON.stringify(t||{})}))}async function d(e){return l(await fetch("".concat(n).concat(e),{method:"DELETE",credentials:"include"}))}async function o(e,t){return l(await fetch("".concat(n).concat(e),{method:"PATCH",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(t||{})}))}},27648:function(e,t,a){"use strict";a.d(t,{default:function(){return n.a}});var s=a(72972),n=a.n(s)}},function(e){e.O(0,[2972,2971,2117,1744],function(){return e(e.s=49791)}),_N_E=e.O()}]);