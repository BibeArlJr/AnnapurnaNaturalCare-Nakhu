(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5687],{49791:function(e,t,s){Promise.resolve().then(s.bind(s,54931))},54931:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return r}});var a=s(57437),l=s(2265),n=s(32617),i=s(27648);function r(){let[e,t]=(0,l.useState)([]),[s,r]=(0,l.useState)(!0),[c,d]=(0,l.useState)(""),[o,u]=(0,l.useState)(null),h=async()=>{r(!0);try{let e=await (0,n.R1)("/patient-reviews?status=all&includeDrafts=true");t((null==e?void 0:e.data)||e||[]),d("")}catch(e){d("Failed to load reviews"),t([])}finally{r(!1)}};(0,l.useEffect)(()=>{h()},[]);let x=async e=>{window.confirm("Delete this review?")&&(await (0,n.QW)("/patient-reviews/".concat(e)),await h())},f=async e=>{let s="published"===e.status?"draft":"published";u(e._id),t(t=>t.map(t=>t._id===e._id?{...t,status:s,publishedAt:"published"===s?new Date().toISOString():t.publishedAt}:t));try{await (0,n.nc)("/patient-reviews/".concat(e._id),{status:s,publishedAt:"published"===s?new Date:void 0})}catch(s){t(t=>t.map(t=>t._id===e._id?{...t,status:e.status,publishedAt:e.publishedAt}:t)),alert("Failed to update status")}finally{u(null)}},p=e=>{if(!e)return"—";try{return new Date(e).toLocaleDateString()}catch(e){return"—"}},m=(0,l.useMemo)(()=>e=>{if(!e)return"";let t=e.toString().replace(/<[^>]+>/g," ").replace(/\s+/g," ").trim();return t.length>140?"".concat(t.slice(0,137),"..."):t},[]),b=e=>{let{status:t}=e,s="published"===t;return(0,a.jsx)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-semibold ".concat(s?"bg-emerald-600/20 text-emerald-200 border border-emerald-500/40":"bg-slate-700/60 text-slate-200 border border-slate-600"),children:s?"Published":"Draft"})},g=e=>{let{item:t}=e;return(0,a.jsx)("button",{onClick:()=>f(t),disabled:o===t._id,className:"relative inline-flex h-7 w-12 items-center rounded-full border ".concat("published"===t.status?"bg-emerald-600/30 border-emerald-400":"bg-slate-700 border-slate-500"," transition"),"aria-label":"Toggle publish",children:(0,a.jsx)("span",{className:"absolute left-1 h-5 w-5 rounded-full bg-white transition-transform ".concat("published"===t.status?"translate-x-5":"translate-x-0")})})};return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-2xl font-semibold text-white",children:"Patient Reviews"}),(0,a.jsx)("p",{className:"text-sm text-slate-400",children:"Manage patient testimonials."})]}),(0,a.jsx)(i.default,{href:"/admin/reviews/new",className:"px-4 py-2 rounded-lg bg-teal-600 text-white text-sm hover:bg-teal-500",children:"Add review"})]}),s?(0,a.jsx)("p",{className:"text-slate-400",children:"Loading..."}):c?(0,a.jsx)("p",{className:"text-red-400",children:c}):0===e.length?(0,a.jsx)("p",{className:"text-slate-400",children:"No reviews yet."}):(0,a.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-3 gap-4",children:e.map(e=>(0,a.jsxs)("div",{className:"bg-[#0f131a] border border-slate-800 rounded-xl shadow-lg overflow-hidden flex flex-col",children:[(0,a.jsxs)("div",{className:"relative h-40 bg-slate-900",children:[e.coverImage||e.photo?(0,a.jsx)("img",{src:e.coverImage||e.photo,alt:e.patientName,className:"w-full h-full object-cover"}):(0,a.jsx)("div",{className:"w-full h-full bg-gradient-to-br from-slate-800 to-slate-900"}),(0,a.jsx)("div",{className:"absolute top-2 left-2 flex items-center gap-2",children:(0,a.jsx)(b,{status:e.status})})]}),(0,a.jsxs)("div",{className:"p-4 flex flex-col gap-3 flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-semibold text-white",children:e.patientName}),e.country?(0,a.jsx)("p",{className:"text-xs text-slate-400",children:e.country}):null]}),(0,a.jsx)(g,{item:e})]}),(0,a.jsx)("p",{className:"text-base font-semibold text-white line-clamp-2",children:e.headline}),(0,a.jsxs)("div",{className:"text-xs text-slate-400 flex items-center gap-2",children:[e.rating?(0,a.jsx)("span",{className:"text-amber-400",children:"".concat(e.rating,"/5")}):(0,a.jsx)("span",{className:"text-slate-600",children:"No rating"}),(0,a.jsxs)("span",{children:["• Created ",p(e.createdAt)]}),e.updatedAt?(0,a.jsxs)("span",{children:["• Updated ",p(e.updatedAt)]}):null]}),e.fullReview?(0,a.jsx)("p",{className:"text-sm text-slate-300 line-clamp-3",children:m(e.fullReview)}):null,(0,a.jsxs)("div",{className:"flex gap-2 pt-2",children:[(0,a.jsx)(i.default,{href:"/admin/reviews/".concat(e._id),className:"px-3 py-2 text-xs rounded bg-slate-800 text-white hover:bg-slate-700 border border-slate-700",children:"Edit"}),(0,a.jsx)("button",{onClick:()=>x(e._id),className:"px-3 py-2 text-xs rounded bg-rose-900/40 text-rose-200 hover:bg-rose-800/60 border border-rose-700/60",children:"Delete"}),e.slug?(0,a.jsx)(i.default,{href:"/patient-reviews/".concat(e.slug),className:"px-3 py-2 text-xs rounded bg-emerald-900/40 text-emerald-200 hover:bg-emerald-800/60 border border-emerald-700/60",children:"View"}):null]})]})]},e._id))})]})}},32617:function(e,t,s){"use strict";s.d(t,{QW:function(){return o},R1:function(){return r},f8:function(){return n},nc:function(){return u},pE:function(){return d},sg:function(){return c}});let a="http://localhost:5000/api".replace(/\/$/,""),l=a.endsWith("/api")?a:"".concat(a,"/api");function n(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=e.startsWith("/")?e:"/".concat(e),s="".concat(l).concat(t);return console.log("[api] request url:",s),s}async function i(e){let t=await e.json().catch(()=>({}));if(!e.ok){let s=Error((null==t?void 0:t.message)||"Request failed");throw s.status=e.status,s}return t}async function r(e){return i(await fetch(n(e),{method:"GET",credentials:"include"}))}async function c(e,t){let s="undefined"!=typeof FormData&&t instanceof FormData;return i(await fetch(n(e),{method:"POST",credentials:"include",headers:s?void 0:{"Content-Type":"application/json"},body:s?t:JSON.stringify(t||{})}))}async function d(e,t){let s="undefined"!=typeof FormData&&t instanceof FormData;return i(await fetch(n(e),{method:"PUT",credentials:"include",headers:s?void 0:{"Content-Type":"application/json"},body:s?t:JSON.stringify(t||{})}))}async function o(e){return i(await fetch(n(e),{method:"DELETE",credentials:"include"}))}async function u(e,t){return i(await fetch(n(e),{method:"PATCH",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(t||{})}))}},27648:function(e,t,s){"use strict";s.d(t,{default:function(){return l.a}});var a=s(72972),l=s.n(a)}},function(e){e.O(0,[2972,2971,2117,1744],function(){return e(e.s=49791)}),_N_E=e.O()}]);