(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9590],{78006:function(e,t,s){Promise.resolve().then(s.bind(s,93138))},93138:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return c}});var a=s(57437),l=s(2265),n=s(71096),i=s.n(n),r=s(49990),o=s(32617);function c(){let[e,t]=(0,l.useState)([]),[s,n]=(0,l.useState)(!0),[c,d]=(0,l.useState)(!1),[x,m]=(0,l.useState)(!1),[p,u]=(0,l.useState)(null),[h,g]=(0,l.useState)({date:"",time:"",message:""}),[b,f]=(0,l.useState)(!1),[N,j]=(0,l.useState)(null),[v,y]=(0,l.useState)({message:"",notifyPatient:!0}),[w,C]=(0,l.useState)(null),[k,P]=(0,l.useState)(!1),[D,E]=(0,l.useState)(!1),[S,A]=(0,l.useState)(null),[M,_]=(0,l.useState)({patientName:"",patientEmail:"",patientPhone:"",date:"",time:"",service:"",doctor:"",status:"pending",notifyPatient:!1}),Y=i()().format("YYYY-MM-DD"),z=i()().add(1,"day").format("YYYY-MM-DD");function F(e){return e?i()(e).format("YYYY-MM-DD"):""}let L=e=>{let t={pending:"bg-yellow-600/30 text-yellow-300 border-yellow-600",confirmed:"bg-teal-600/30 text-teal-300 border-teal-600",cancelled:"bg-rose-600/30 text-rose-300 border-rose-600",completed:"bg-blue-600/30 text-blue-300 border-blue-600",rescheduled:"bg-blue-600/30 text-blue-300 border-blue-600"},s=t[e]||t.pending;return(0,a.jsx)("span",{className:"text-xs px-2 py-0.5 rounded-full border inline-block ml-2 ".concat(s),children:(e||"pending").charAt(0).toUpperCase()+(e||"pending").slice(1)})};function R(e){var t;return(null===(t=e.doctor)||void 0===t?void 0:t.name)||e.doctor||e.doctorName||"No doctor assigned"}function T(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if(!e)return"";if(e.includes("AM")||e.includes("PM"))return e;try{let[t,s]=e.split(":"),a=Number(t);return(a+11)%12+1+":"+s+" "+(a>=12?"PM":"AM")}catch(t){return e}}async function O(){n(!0);try{let e=await (0,o.R1)("/appointments"),s=(null==e?void 0:e.data)||e||[];t(s)}catch(e){console.error("Appointments load error:",e)}n(!1)}function U(e){C(e),P(!0)}function q(e){A(e),_({patientName:e.patientName||e.name||"",patientEmail:e.patientEmail||e.email||"",patientPhone:e.patientPhone||e.phone||"",date:F(e.date)||"",time:e.time||"",service:e.service||e.departmentName||"",doctor:e.doctorName||e.doctor||"",status:e.status||"pending",notifyPatient:!1,message:e.message||""}),E(!0)}function I(e){u(e),g({date:F(e.date),time:e.time||"",message:e.adminMessage||""}),m(!0)}(0,l.useEffect)(()=>{O()},[]);let Q=e.filter(e=>F(e.date)===Y),W=e.filter(e=>F(e.date)===z),Z=e.filter(e=>{let t=F(e.date);return"pending"===e.status||t&&t>z}),B=[...e].sort((e,t)=>{let s=F(e.date),a=F(t.date);return s&&a?a.localeCompare(s):s?-1:a?1:(t.createdAt||"").localeCompare(e.createdAt||"")});async function G(e,t){try{await (0,o.pE)("/appointments/".concat(e._id,"/status"),{status:t}),O()}catch(e){alert(e.message||"Failed to update")}}async function H(e){if(window.confirm("Delete appointment for ".concat(e.patientName||apt.name||"patient"," on ").concat(F(e.date)||"date","?")))try{await (0,o.QW)("/appointments/".concat(e._id)),O()}catch(e){alert((null==e?void 0:e.message)||"Failed to delete appointment")}}return(0,a.jsxs)("div",{className:"space-y-8",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-2xl font-semibold text-white",children:"Appointments"}),(0,a.jsx)("p",{className:"text-gray-400",children:"Manage all patient bookings"})]}),(0,a.jsx)("button",{onClick:()=>d(!0),className:"px-4 py-2 rounded-lg bg-teal-600 text-white hover:bg-teal-500",children:"+ Add Appointment"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{className:"bg-[#0f131a] border border-white/10 rounded-xl p-6 space-y-3",children:[(0,a.jsxs)("h2",{className:"text-lg font-semibold text-white",children:["Today's Appointments (",Y,")"]}),s?(0,a.jsx)("p",{className:"text-slate-400 text-sm",children:"Loading..."}):0===Q.length?(0,a.jsx)("p",{className:"text-slate-500 text-sm",children:"No appointments today."}):Q.map(e=>(0,a.jsxs)("div",{className:"border border-white/5 rounded-lg p-3 hover:border-teal-600/50 transition cursor-pointer",onClick:()=>U(e),children:[(0,a.jsx)("p",{className:"text-white font-medium hover:text-teal-400 transition",children:e.patientName||e.name}),(0,a.jsx)("p",{className:"text-slate-400 text-xs",children:e.patientEmail||e.email}),(0,a.jsxs)("p",{className:"text-slate-400 text-xs flex items-center gap-1",children:[T(e.time)," • Dr. ",R(e),L(e.status)]})]},e._id))]}),(0,a.jsxs)("div",{className:"bg-[#0f131a] border border-white/10 rounded-xl p-6 space-y-3",children:[(0,a.jsxs)("h2",{className:"text-lg font-semibold text-white",children:["Next Day's Appointments (",z,")"]}),s?(0,a.jsx)("p",{className:"text-slate-400 text-sm",children:"Loading..."}):0===W.length?(0,a.jsx)("p",{className:"text-slate-500 text-sm",children:"No appointments tomorrow."}):W.map(e=>(0,a.jsxs)("div",{className:"border border-white/5 rounded-lg p-3 hover:border-teal-600/50 transition cursor-pointer",onClick:()=>U(e),children:[(0,a.jsx)("p",{className:"text-white font-medium hover:text-teal-400 transition",children:e.patientName||e.name}),(0,a.jsx)("p",{className:"text-slate-400 text-xs",children:e.patientEmail||e.email}),(0,a.jsxs)("p",{className:"text-slate-400 text-xs flex items-center gap-1",children:[T(e.time)," • Dr. ",R(e),L(e.status)]})]},e._id))]})]}),(0,a.jsxs)("div",{className:"bg-[#0f131a] border border-white/10 rounded-xl p-6 space-y-4",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold text-white",children:"Upcoming Appointments (Pending Confirmation)"}),s?(0,a.jsx)("p",{className:"text-slate-400 text-sm",children:"Loading..."}):0===Z.length?(0,a.jsx)("p",{className:"text-slate-500 text-sm",children:"No pending or upcoming appointments."}):Z.map(e=>(0,a.jsxs)("div",{className:"border border-white/5 rounded-lg p-4 flex flex-col md:flex-row md:items-center md:justify-between gap-3 hover:border-teal-600/50 transition",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-white font-semibold hover:text-teal-400 cursor-pointer transition",onClick:()=>U(e),children:e.patientName||e.name}),(0,a.jsx)("p",{className:"text-slate-400 text-xs",children:e.patientEmail||e.email}),(0,a.jsxs)("p",{className:"text-slate-400 text-xs",children:[F(e.date)," \xb7 ",T(e.time)," • Dr. ",R(e),L(e.status)]}),(0,a.jsxs)("p",{className:"text-slate-500 text-xs",children:[e.service||e.departmentName||"Department"," \xb7 ",e.doctor||e.doctorName||"Doctor"]})]}),(0,a.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,a.jsx)("button",{onClick:()=>q(e),className:"px-3 py-2 rounded-lg bg-slate-800 text-white hover:bg-slate-700 text-xs",children:"Edit"}),(0,a.jsx)("button",{onClick:()=>G(e,"confirmed"),className:"px-3 py-2 rounded-lg bg-teal-600 text-white hover:bg-teal-500 text-xs",children:"Confirm"}),(0,a.jsx)("button",{onClick:()=>{j(e),y({message:"",notifyPatient:!0}),f(!0)},className:"px-3 py-2 rounded-lg bg-rose-600 text-white hover:bg-rose-500 text-xs",children:"Cancel"}),(0,a.jsx)("button",{onClick:()=>{I(e)},className:"px-3 py-2 rounded-lg bg-slate-800 text-white hover:bg-slate-700 text-xs",children:"Reschedule"}),(0,a.jsx)("button",{onClick:()=>H(e),className:"px-3 py-2 rounded-lg bg-slate-700 text-white hover:bg-slate-600 text-xs",children:"Delete"})]})]},e._id))]}),(0,a.jsx)(r.Z,{open:c,onClose:()=>d(!1),onSaved:()=>{O()}}),b&&N&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50 px-4",children:(0,a.jsxs)("div",{className:"relative w-full max-w-md bg-[#0f131a] border border-white/10 rounded-2xl p-5 space-y-3 text-white",children:[(0,a.jsx)("button",{onClick:()=>f(!1),className:"absolute top-3 right-3 text-gray-300 hover:text-white",children:"✕"}),(0,a.jsx)("h3",{className:"text-lg font-semibold",children:"Cancel Appointment"}),(0,a.jsx)("p",{className:"text-sm text-slate-300",children:"Please provide a reason. You can choose whether to email the patient."}),(0,a.jsxs)("form",{className:"space-y-3",onSubmit:async e=>{if(e.preventDefault(),!v.message.trim()){alert("Please enter a cancellation reason.");return}try{await (0,o.pE)("/appointments/".concat(N._id,"/status"),{status:"cancelled",adminMessage:v.message.trim(),notifyPatient:v.notifyPatient}),O(),f(!1),j(null),y({message:"",notifyPatient:!0})}catch(e){alert((null==e?void 0:e.message)||"Failed to cancel")}},children:[(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)("label",{className:"text-sm text-slate-300",children:"Message to patient"}),(0,a.jsx)("textarea",{rows:4,value:v.message,onChange:e=>y(t=>({...t,message:e.target.value})),className:"w-full bg-slate-800 border border-slate-700 rounded-xl px-3 py-2 text-white focus:outline-none focus:ring-2 focus:ring-teal-500 resize-none",placeholder:"Provide cancellation reason and next steps"})]}),(0,a.jsxs)("label",{className:"flex items-center gap-2 text-sm text-slate-300",children:[(0,a.jsx)("input",{type:"checkbox",checked:v.notifyPatient,onChange:e=>y(t=>({...t,notifyPatient:e.target.checked})),className:"rounded border-slate-600 bg-slate-800"}),"Notify patient via email"]}),(0,a.jsxs)("div",{className:"flex justify-end gap-2 pt-2",children:[(0,a.jsx)("button",{type:"button",onClick:()=>f(!1),className:"px-4 py-2 rounded-lg bg-slate-800 hover:bg-slate-700",children:"Close"}),(0,a.jsx)("button",{type:"submit",className:"px-4 py-2 rounded-lg bg-rose-600 hover:bg-rose-500",children:"Cancel Appointment"})]})]})]})}),(0,a.jsxs)("div",{className:"bg-[#0f131a] border border-white/10 rounded-xl p-6 space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold text-white",children:"All Appointments"}),(0,a.jsx)("p",{className:"text-xs text-slate-400",children:"Includes past, cancelled, and confirmed"})]}),s?(0,a.jsx)("p",{className:"text-slate-400 text-sm",children:"Loading..."}):0===B.length?(0,a.jsx)("p",{className:"text-slate-500 text-sm",children:"No appointments found."}):B.map(e=>(0,a.jsxs)("div",{className:"border border-white/5 rounded-lg p-4 flex flex-col md:flex-row md:items-center md:justify-between gap-3 hover:border-teal-600/50 transition",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-white font-semibold",children:e.patientName||e.name}),(0,a.jsx)("p",{className:"text-slate-400 text-xs",children:e.patientEmail||e.email}),(0,a.jsxs)("p",{className:"text-slate-400 text-xs flex items-center gap-1",children:[F(e.date)||"No date"," \xb7 ",T(e.time)," • Dr. ",R(e),L(e.status)]}),(0,a.jsxs)("p",{className:"text-slate-500 text-xs",children:[e.service||e.departmentName||"Department"," \xb7 ",e.doctor||e.doctorName||"Doctor"]})]}),(0,a.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,a.jsx)("button",{onClick:()=>q(e),className:"px-3 py-2 rounded-lg bg-slate-800 text-white hover:bg-slate-700 text-xs",children:"Edit"}),(0,a.jsx)("button",{onClick:()=>G(e,"confirmed"),className:"px-3 py-2 rounded-lg bg-teal-600 text-white hover:bg-teal-500 text-xs",children:"Confirm"}),(0,a.jsx)("button",{onClick:()=>{j(e),y({message:"",notifyPatient:!0}),f(!0)},className:"px-3 py-2 rounded-lg bg-rose-600 text-white hover:bg-rose-500 text-xs",children:"Cancel"}),(0,a.jsx)("button",{onClick:()=>I(e),className:"px-3 py-2 rounded-lg bg-slate-800 text-white hover:bg-slate-700 text-xs",children:"Reschedule"}),(0,a.jsx)("button",{onClick:()=>H(e),className:"px-3 py-2 rounded-lg bg-slate-700 text-white hover:bg-slate-600 text-xs",children:"Delete"})]})]},e._id))]}),x&&p&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50 px-4",children:(0,a.jsxs)("div",{className:"relative w-full max-w-md bg-[#0f131a] border border-white/10 rounded-2xl p-5 space-y-3 text-white",children:[(0,a.jsx)("button",{onClick:()=>m(!1),className:"absolute top-3 right-3 text-gray-300 hover:text-white",children:"✕"}),(0,a.jsx)("h3",{className:"text-lg font-semibold",children:"Reschedule Appointment"}),(0,a.jsxs)("form",{className:"space-y-3",onSubmit:async e=>{if(e.preventDefault(),!h.date&&!h.time){alert("Please add a new date or time.");return}try{await (0,o.pE)("/appointments/".concat(p._id,"/reschedule"),{date:h.date||p.date,time:h.time||p.time,status:"rescheduled",adminMessage:h.message||p.adminMessage||"",notifyPatient:!0}),O(),m(!1),u(null),g({date:"",time:"",message:""})}catch(e){alert((null==e?void 0:e.message)||"Failed to reschedule")}},children:[(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)("label",{className:"text-sm text-slate-300",children:"New Date"}),(0,a.jsx)("input",{type:"date",value:h.date,onChange:e=>g(t=>({...t,date:e.target.value})),className:"w-full bg-slate-800 border border-slate-700 rounded-xl px-3 py-2 text-white focus:outline-none focus:ring-2 focus:ring-teal-500"})]}),(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)("label",{className:"text-sm text-slate-300",children:"New Time"}),(0,a.jsx)("input",{type:"time",value:h.time,onChange:e=>g(t=>({...t,time:e.target.value})),className:"w-full bg-slate-800 border border-slate-700 rounded-xl px-3 py-2 text-white focus:outline-none focus:ring-2 focus:ring-teal-500"})]}),(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)("label",{className:"text-sm text-slate-300",children:"Message to patient"}),(0,a.jsx)("textarea",{rows:3,value:h.message,onChange:e=>g(t=>({...t,message:e.target.value})),className:"w-full bg-slate-800 border border-slate-700 rounded-xl px-3 py-2 text-white focus:outline-none focus:ring-2 focus:ring-teal-500 resize-none",placeholder:"Share the updated schedule or instructions"})]}),(0,a.jsxs)("div",{className:"flex justify-end gap-2 pt-2",children:[(0,a.jsx)("button",{type:"button",onClick:()=>m(!1),className:"px-4 py-2 rounded-lg bg-slate-800 hover:bg-slate-700",children:"Cancel"}),(0,a.jsx)("button",{type:"submit",className:"px-4 py-2 rounded-lg bg-teal-600 hover:bg-teal-500",children:"Save & Notify"})]})]})]})}),D&&S&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50 px-4",children:(0,a.jsxs)("div",{className:"relative w-full max-w-2xl bg-[#0f131a] border border-white/10 rounded-2xl p-6 space-y-4 text-white",children:[(0,a.jsx)("button",{onClick:()=>E(!1),className:"absolute top-3 right-3 text-gray-300 hover:text-white",children:"✕"}),(0,a.jsx)("h3",{className:"text-lg font-semibold",children:"Edit Appointment"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)("label",{className:"text-sm text-slate-300",children:"Patient Name"}),(0,a.jsx)("input",{value:M.patientName,onChange:e=>_(t=>({...t,patientName:e.target.value})),className:"w-full bg-slate-800 border border-slate-700 rounded-xl px-3 py-2 text-white focus:outline-none focus:ring-2 focus:ring-teal-500"})]}),(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)("label",{className:"text-sm text-slate-300",children:"Email"}),(0,a.jsx)("input",{type:"email",value:M.patientEmail,onChange:e=>_(t=>({...t,patientEmail:e.target.value})),className:"w-full bg-slate-800 border border-slate-700 rounded-xl px-3 py-2 text-white focus:outline-none focus:ring-2 focus:ring-teal-500"})]}),(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)("label",{className:"text-sm text-slate-300",children:"Phone"}),(0,a.jsx)("input",{value:M.patientPhone,onChange:e=>_(t=>({...t,patientPhone:e.target.value})),className:"w-full bg-slate-800 border border-slate-700 rounded-xl px-3 py-2 text-white focus:outline-none focus:ring-2 focus:ring-teal-500"})]}),(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)("label",{className:"text-sm text-slate-300",children:"Date"}),(0,a.jsx)("input",{type:"date",value:M.date,onChange:e=>_(t=>({...t,date:e.target.value})),className:"w-full bg-slate-800 border border-slate-700 rounded-xl px-3 py-2 text-white focus:outline-none focus:ring-2 focus:ring-teal-500"})]}),(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)("label",{className:"text-sm text-slate-300",children:"Time"}),(0,a.jsx)("input",{type:"time",value:M.time,onChange:e=>_(t=>({...t,time:e.target.value})),className:"w-full bg-slate-800 border border-slate-700 rounded-xl px-3 py-2 text-white focus:outline-none focus:ring-2 focus:ring-teal-500"})]}),(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)("label",{className:"text-sm text-slate-300",children:"Department / Service"}),(0,a.jsx)("input",{value:M.service,onChange:e=>_(t=>({...t,service:e.target.value})),className:"w-full bg-slate-800 border border-slate-700 rounded-xl px-3 py-2 text-white focus:outline-none focus:ring-2 focus:ring-teal-500"})]}),(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)("label",{className:"text-sm text-slate-300",children:"Doctor"}),(0,a.jsx)("input",{value:M.doctor,onChange:e=>_(t=>({...t,doctor:e.target.value,doctorName:e.target.value})),className:"w-full bg-slate-800 border border-slate-700 rounded-xl px-3 py-2 text-white focus:outline-none focus:ring-2 focus:ring-teal-500"})]}),(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)("label",{className:"text-sm text-slate-300",children:"Status"}),(0,a.jsx)("select",{value:M.status,onChange:e=>_(t=>({...t,status:e.target.value})),className:"w-full bg-slate-800 border border-slate-700 rounded-xl px-3 py-2 text-white focus:outline-none focus:ring-2 focus:ring-teal-500",children:["pending","confirmed","rescheduled","cancelled","completed"].map(e=>(0,a.jsx)("option",{value:e,children:e},e))})]}),(0,a.jsxs)("div",{className:"space-y-1 md:col-span-2",children:[(0,a.jsx)("label",{className:"text-sm text-slate-300",children:"Notes / Message"}),(0,a.jsx)("textarea",{rows:3,value:M.message||"",onChange:e=>_(t=>({...t,message:e.target.value})),className:"w-full bg-slate-800 border border-slate-700 rounded-xl px-3 py-2 text-white focus:outline-none focus:ring-2 focus:ring-teal-500 resize-none"})]}),(0,a.jsxs)("label",{className:"flex items-center gap-2 text-sm text-slate-300 md:col-span-2",children:[(0,a.jsx)("input",{type:"checkbox",checked:M.notifyPatient,onChange:e=>_(t=>({...t,notifyPatient:e.target.checked})),className:"rounded border-slate-600 bg-slate-800"}),"Notify patient by email about this change"]})]}),(0,a.jsxs)("div",{className:"flex justify-end gap-3",children:[(0,a.jsx)("button",{onClick:()=>E(!1),className:"px-4 py-2 rounded-lg bg-slate-800 hover:bg-slate-700 text-white",children:"Close"}),(0,a.jsx)("button",{onClick:async()=>{if(!M.patientName||!M.patientPhone){alert("Name and phone are required");return}try{await (0,o.pE)("/appointments/".concat(S._id),{patientName:M.patientName,patientEmail:M.patientEmail,patientPhone:M.patientPhone,date:M.date,time:M.time,service:M.service,doctor:M.doctor,doctorName:M.doctor,status:M.status,message:M.message,notifyPatient:M.notifyPatient}),E(!1),A(null),O()}catch(e){alert((null==e?void 0:e.message)||"Failed to update appointment")}},className:"px-4 py-2 rounded-lg bg-teal-600 hover:bg-teal-500 text-white",children:"Save Changes"})]})]})})]})}}},function(e){e.O(0,[2850,7142,2333,5501,7837,2416,9990,2971,2117,1744],function(){return e(e.s=78006)}),_N_E=e.O()}]);