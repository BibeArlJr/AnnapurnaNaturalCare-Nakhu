(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2861],{64293:function(e,t,a){Promise.resolve().then(a.bind(a,79802))},79802:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return d}});var n=a(57437),s=a(2265),l=a(71096),r=a.n(l),o=a(98197),i=a(49990),c=a(32617);function d(){let[e,t]=(0,s.useState)([]),[a,l]=(0,s.useState)(r()().format("YYYY-MM-DD")),[d,u]=(0,s.useState)([]),[m,p]=(0,s.useState)(!0),[x,h]=(0,s.useState)(!1),[f,b]=(0,s.useState)(!1),[v,g]=(0,s.useState)(null),[y,w]=(0,s.useState)({message:"",notifyPatient:!0});async function N(){try{let e=await (0,c.R1)("/appointments"),a=((null==e?void 0:e.data)||e||[]).map(e=>{var t,a;return{id:e._id,title:e.patientName||"Appointment",start:r()(e.date).format("YYYY-MM-DD"),extendedProps:{...e,date:r()(e.date).format("YYYY-MM-DD"),doctorName:(null===(t=e.doctor)||void 0===t?void 0:t.name)||e.doctor,departmentName:(null===(a=e.service)||void 0===a?void 0:a.name)||e.service}}});t(a)}catch(e){console.error("Calendar load error:",e)}}async function j(e){p(!0);try{let t=await (0,c.R1)("/appointments?date=".concat(e)),a=(null==t?void 0:t.data)||t||[];u(a)}catch(e){console.error("Daily load error:",e)}p(!1)}async function C(e){if(window.confirm("Delete appointment for ".concat(e.patientName||e.name||"patient"," on ").concat(e.date||"date","?")))try{await (0,c.QW)("/appointments/".concat(e._id)),N(),j(a),b(!1),g(null)}catch(e){alert((null==e?void 0:e.message)||"Failed to delete")}}return(0,s.useEffect)(()=>{N()},[]),(0,s.useEffect)(()=>{j(a)},[a]),(0,n.jsxs)("div",{className:"space-y-8",children:[(0,n.jsxs)("div",{className:"flex justify-between items-center",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("h1",{className:"text-2xl font-semibold text-white",children:"Appointments Calendar"}),(0,n.jsx)("p",{className:"text-gray-400",children:"View bookings on the calendar"})]}),(0,n.jsx)("button",{onClick:()=>h(!0),className:"px-4 py-2 rounded-lg bg-teal-600 text-white hover:bg-teal-500",children:"+ Add Appointment"})]}),(0,n.jsx)(o.Z,{events:e,onDateSelect:e=>l(e),onEventClick:e=>{g(e.event.extendedProps),w({message:"",notifyPatient:!0}),b(!0)}}),(0,n.jsx)(i.Z,{open:x,onClose:()=>h(!1),onSaved:()=>{N(),j(a)}}),f&&v&&(0,n.jsx)("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50 px-4",children:(0,n.jsxs)("div",{className:"relative w-full max-w-md bg-[#0f131a] border border-white/10 rounded-2xl p-5 space-y-3 text-white",children:[(0,n.jsx)("button",{onClick:()=>b(!1),className:"absolute top-3 right-3 text-gray-300 hover:text-white",children:"âœ•"}),(0,n.jsx)("h3",{className:"text-lg font-semibold",children:"Cancel Appointment"}),(0,n.jsx)("p",{className:"text-sm text-slate-300",children:"Please provide a reason. You can choose whether to email the patient."}),(0,n.jsxs)("form",{className:"space-y-3",onSubmit:async e=>{if(e.preventDefault(),!y.message.trim()){alert("Please enter a cancellation reason.");return}try{await (0,c.pE)("/appointments/".concat(v._id,"/status"),{status:"cancelled",adminMessage:y.message.trim(),notifyPatient:y.notifyPatient}),N(),j(a),b(!1),g(null),w({message:"",notifyPatient:!0}),setShowDetailsModal(!1)}catch(e){alert((null==e?void 0:e.message)||"Failed to cancel")}},children:[(0,n.jsxs)("div",{className:"space-y-1",children:[(0,n.jsx)("label",{className:"text-sm text-slate-300",children:"Message to patient"}),(0,n.jsx)("textarea",{rows:4,value:y.message,onChange:e=>w(t=>({...t,message:e.target.value})),className:"w-full bg-slate-800 border border-slate-700 rounded-xl px-3 py-2 text-white focus:outline-none focus:ring-2 focus:ring-teal-500 resize-none",placeholder:"Provide cancellation reason and next steps"})]}),(0,n.jsxs)("label",{className:"flex items-center gap-2 text-sm text-slate-300",children:[(0,n.jsx)("input",{type:"checkbox",checked:y.notifyPatient,onChange:e=>w(t=>({...t,notifyPatient:e.target.checked})),className:"rounded border-slate-600 bg-slate-800"}),"Notify patient via email"]}),(0,n.jsxs)("div",{className:"flex justify-end gap-2 pt-2",children:[(0,n.jsx)("button",{type:"button",onClick:()=>b(!1),className:"px-4 py-2 rounded-lg bg-slate-800 hover:bg-slate-700",children:"Close"}),(0,n.jsx)("button",{type:"button",onClick:()=>C(v),className:"px-4 py-2 rounded-lg bg-slate-700 hover:bg-slate-600",children:"Delete"}),(0,n.jsx)("button",{type:"submit",className:"px-4 py-2 rounded-lg bg-rose-600 hover:bg-rose-500",children:"Cancel Appointment"})]})]})]})})]})}},98197:function(e,t,a){"use strict";a.d(t,{Z:function(){return i}});var n=a(57437),s=a(2265),l=a(85262),r=a(48185),o=a(62516);function i(e){let{events:t,onDateSelect:a,onEventClick:i}=e,c=(0,s.useRef)(null),d=e=>{switch(e){case"cancelled":return"bg-[#7f2d38] border-[#b55460] text-white";case"confirmed":return"bg-[#0d5047] border-[#31b8a4] text-white";case"pending":return"bg-[#725d27] border-[#d1b84a] text-white";case"completed":case"rescheduled":return"bg-[#234d7f] border-[#4b8fd1] text-white";default:return"bg-[#2a2e35] border-[#3b3f46] text-white"}};return(0,s.useEffect)(()=>()=>{var e,t;let a=null===(t=c.current)||void 0===t?void 0:null===(e=t.getApi)||void 0===e?void 0:e.call(t);null==a||a.destroy()},[]),(0,n.jsx)("div",{className:"border border-white/5 bg-[#0e1217] rounded-xl p-4",children:(0,n.jsx)(l.Z,{ref:c,plugins:[r.Z,o.ZP],initialView:"dayGridMonth",height:650,events:t,dateClick:e=>a(e.dateStr),eventClick:e=>null==i?void 0:i(e),eventContent:e=>({html:'<span class="truncate block">'.concat(e.event.title,"</span>")}),eventClassNames:e=>{var t;return"px-2 py-1 rounded-md text-xs truncate border cursor-pointer ".concat(d(null===(t=e.event.extendedProps)||void 0===t?void 0:t.status))}})})}a(32972)},32972:function(){}},function(e){e.O(0,[9021,2850,7142,8554,2333,5501,7837,2416,4157,9990,2971,2117,1744],function(){return e(e.s=64293)}),_N_E=e.O()}]);