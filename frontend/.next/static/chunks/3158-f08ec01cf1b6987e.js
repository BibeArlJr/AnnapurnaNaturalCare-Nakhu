"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3158],{88328:function(e,t,a){a.d(t,{Z:function(){return i}});var s=a(57437),n=a(2265),l=a(32617);let o={name:"",email:"",phone:"",preferredStartDate:"",people:1,notes:""},r={none:"No accommodation",location:"Choose by location",star:"Choose by hotel rating",locationAndStar:"Choose by location & rating"};function i(e){let{pkg:t,onClose:a}=e,[i,c]=(0,n.useState)(o),[d,u]=(0,n.useState)(!1),[m,x]=(0,n.useState)(!1),[f,p]=(0,n.useState)(null),[h,b]=(0,n.useState)([]),[g,N]=(0,n.useState)("none"),[j,y]=(0,n.useState)(""),[v,w]=(0,n.useState)(""),[D,k]=(0,n.useState)(null),S=(0,n.useMemo)(()=>(null==t?void 0:t.duration)||(null==t?void 0:t.durationDays)||1,[null==t?void 0:t.duration,null==t?void 0:t.durationDays]),C=(null==t?void 0:t.price)&&Number(t.price)>0?Number(t.price):null,F=C?C*(Number(i.people)||1):null;(0,n.useEffect)(()=>{(async()=>{try{let e=await (0,l.R1)("/partner-hotels/public"),t=(null==e?void 0:e.data)||e||[];b(t),t.length&&"none"!==g&&(y(t[0].location||""),w(t[0].starRating||""),k(t[0]._id))}catch(e){console.error("Partner hotels load error:",e)}})()},[]);let P=(0,n.useMemo)(()=>Array.from(new Set((h||[]).map(e=>e.location).filter(Boolean))),[h]),R=(0,n.useMemo)(()=>Array.from(new Set((h||[]).map(e=>e.starRating).filter(Boolean))).sort(),[h]),_=(0,n.useMemo)(()=>"location"===g?h.filter(e=>!j||e.location===j):"star"===g?h.filter(e=>!v||Number(e.starRating)===Number(v)):"locationAndStar"===g?h.filter(e=>(!j||e.location===j)&&(!v||Number(e.starRating)===Number(v))):[],[g,h,j,v]);(0,n.useEffect)(()=>{if("none"===g){k(null);return}_.length&&!D&&(k(_[0]._id),!j&&_[0].location&&y(_[0].location),!v&&_[0].starRating&&w(_[0].starRating)),_.length||k(null)},[_,g,D,j,v]);let A="none"===g?null:_.find(e=>e._id===D)||_[0],E=A&&Number(A.pricePerNight)||0,T=E*(S||1),$=null!==F?F+T:null,q=e=>{let{name:t,value:a}=e.target;if("people"===t){let e=Math.max(1,Number(a)||1);c(a=>({...a,[t]:e}));return}c(e=>({...e,[t]:a}))},B=()=>{x(!1),p(null),c(o),N("none"),y(""),w(""),k(null),null==a||a()},M=async e=>{if(e.preventDefault(),!i.name||!i.email||!i.phone||!i.people||1>Number(i.people)){alert("Please fill name, email, phone, and at least 1 person.");return}u(!0);try{var a;let e=await (0,l.sg)("/package-bookings",{packageId:t._id,packageName:t.name,name:i.name,email:i.email,phone:i.phone,preferredStartDate:i.preferredStartDate,people:Number(i.people)||1,notes:i.notes,accommodationMode:g,selectedLocation:j,selectedStarRating:v,partnerHotelId:null==A?void 0:A._id,accommodationPricePerNight:E,accommodationNights:S||1,accommodationTotalCost:T,totalAmount:$||void 0});p((null==e?void 0:null===(a=e.data)||void 0===a?void 0:a._id)||(null==e?void 0:e._id)||null),x(!0)}catch(e){alert((null==e?void 0:e.message)||"Failed to submit booking.")}u(!1)},O=async()=>{if(f)try{let e=await (0,l.sg)("/payments/stripe/checkout",{bookingId:f,type:"package"});(null==e?void 0:e.url)&&(window.location.href=e.url)}catch(e){alert((null==e?void 0:e.message)||"Unable to start Stripe checkout.")}},H=(0,s.jsxs)("div",{className:"space-y-2 text-sm text-[#10231a]",children:[(0,s.jsxs)("div",{className:"rounded-lg bg-[#fff7ed] border border-[#f2d5b1] px-3 py-2",children:[(0,s.jsx)("p",{className:"font-semibold text-[#c2410c]",children:"Important"}),(0,s.jsx)("p",{children:"Extra charges apply for any activities or services not listed in the program description."})]}),(0,s.jsxs)("div",{className:"rounded-lg bg-[#fef2f2] border border-[#fecdd3] px-3 py-2",children:[(0,s.jsx)("p",{className:"font-semibold text-[#be123c]",children:"Refund Policy"}),(0,s.jsx)("p",{children:"After payment, booking cancellations will incur a 10% deduction of the total booking cost."})]})]});return t?(0,s.jsx)("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-start justify-center px-4 py-10",onClick:B,children:(0,s.jsxs)("div",{className:"w-full max-w-3xl max-h-[90vh] bg-white rounded-2xl shadow-2xl border border-[#dfe8e2] p-6 md:p-8 space-y-6 overflow-y-auto",onClick:e=>e.stopPropagation(),children:[(0,s.jsxs)("div",{className:"flex items-start justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-xs uppercase tracking-[0.2em] text-[#2F8D59] font-semibold",children:"Package Booking"}),(0,s.jsx)("h3",{className:"text-xl font-semibold text-[#10231a]",children:null==t?void 0:t.name}),(0,s.jsxs)("p",{className:"text-sm text-[#4c5f68]",children:[(null==t?void 0:t.duration)?"".concat(t.duration," days"):""," \xb7 ",C&&C>0?"$".concat(C):"Contact for pricing"]})]}),(0,s.jsx)("button",{onClick:B,className:"text-sm text-[#2F8D59] font-semibold","aria-label":"Close booking",children:"✕"})]}),m?(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3 text-sm",children:[(0,s.jsxs)("div",{className:"rounded-xl border border-[#dfe8e2] bg-[#f5f8f4] px-4 py-3",children:[(0,s.jsx)("p",{className:"text-[#4c5f68]",children:"Price per person"}),(0,s.jsx)("p",{className:"font-semibold text-[#10231a]",children:C?"$".concat(C):"—"})]}),(0,s.jsxs)("div",{className:"rounded-xl border border-[#dfe8e2] bg-[#f5f8f4] px-4 py-3",children:[(0,s.jsx)("p",{className:"text-[#4c5f68]",children:"Accommodation"}),(0,s.jsx)("p",{className:"font-semibold text-[#10231a]",children:"none"===g?"No accommodation":"$".concat(E," / night")})]}),(0,s.jsxs)("div",{className:"rounded-xl border-2 border-[#2F8D59] bg-[#e6f2ea] px-4 py-3",children:[(0,s.jsx)("p",{className:"text-[#2F8D59] font-semibold",children:"Total amount"}),(0,s.jsx)("p",{className:"text-lg font-bold text-[#10231a]",children:$?"$".concat($):"—"})]})]}),"none"!==g&&A&&(0,s.jsxs)("div",{className:"text-sm text-[#10231a] bg-[#f5f8f4] border border-[#dfe8e2] rounded-xl px-4 py-3",children:[(0,s.jsx)("p",{className:"font-semibold text-[#2F8D59]",children:"Partner hotel"}),(0,s.jsxs)("p",{children:[A.location," ",A.starRating?"\xb7 ".concat(A.starRating,"★"):""," — $",A.pricePerNight,"/night \xd7 ",S," night",1===S?"":"s"," = $",T]})]}),H,(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsx)("p",{className:"text-sm font-semibold text-[#10231a]",children:"Choose how you want to pay"}),(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3",children:[(0,s.jsx)("button",{onClick:O,className:"flex-1 inline-flex justify-center items-center rounded-full bg-[#2F8D59] text-white text-sm font-semibold px-4 py-3 hover:bg-[#27784c] transition",children:"Pay now with Stripe"}),(0,s.jsx)("button",{onClick:()=>{alert("Booking placed successfully. Pay later to confirm."),B()},className:"flex-1 inline-flex justify-center items-center rounded-full border border-[#dfe8e2] text-[#10231a] text-sm font-semibold px-4 py-3 hover:bg-[#f5f8f4] transition",children:"Pay later"})]})]})]}):(0,s.jsxs)("form",{className:"space-y-4",onSubmit:M,children:[(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)("label",{className:"text-sm text-[#10231a] font-semibold",children:"Full Name"}),(0,s.jsx)("input",{name:"name",required:!0,value:i.name,onChange:q,className:"w-full rounded-xl border border-[#dfe8e2] px-4 py-3 text-sm text-[#10231a] focus:outline-none focus:border-[#2F8D59] focus:ring-2 focus:ring-[#cfe8d6]"})]}),(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)("label",{className:"text-sm text-[#10231a] font-semibold",children:"Email"}),(0,s.jsx)("input",{name:"email",type:"email",required:!0,value:i.email,onChange:q,className:"w-full rounded-xl border border-[#dfe8e2] px-4 py-3 text-sm text-[#10231a] focus:outline-none focus:border-[#2F8D59] focus:ring-2 focus:ring-[#cfe8e2]"})]}),(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)("label",{className:"text-sm text-[#10231a] font-semibold",children:"Phone Number"}),(0,s.jsx)("input",{name:"phone",required:!0,value:i.phone,onChange:q,className:"w-full rounded-xl border border-[#dfe8e2] px-4 py-3 text-sm text-[#10231a] focus:outline-none focus:border-[#2F8D59] focus:ring-2 focus:ring-[#cfe8d6]"})]}),(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)("label",{className:"text-sm text-[#10231a] font-semibold",children:"Selected Package"}),(0,s.jsx)("input",{value:(null==t?void 0:t.name)||"Health Package",readOnly:!0,className:"w-full rounded-xl border border-[#dfe8e2] px-4 py-3 text-sm text-[#10231a] bg-[#f5f8f4]"})]}),(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)("label",{className:"text-sm text-[#10231a] font-semibold",children:"Preferred Start Date"}),(0,s.jsx)("input",{type:"date",name:"preferredStartDate",value:i.preferredStartDate,onChange:q,className:"w-full rounded-xl border border-[#dfe8e2] px-4 py-3 text-sm text-[#10231a] focus:outline-none focus:border-[#2F8D59] focus:ring-2 focus:ring-[#cfe8d6]"})]}),(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)("label",{className:"text-sm text-[#10231a] font-semibold",children:"Number of persons *"}),(0,s.jsx)("input",{type:"number",min:1,name:"people",value:i.people,onChange:q,required:!0,className:"w-full rounded-xl border border-[#dfe8e2] px-4 py-3 text-sm text-[#10231a] focus:outline-none focus:border-[#2F8D59] focus:ring-2 focus:ring-[#cfe8d6]"})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("label",{className:"text-sm text-[#10231a] font-semibold",children:"Partner hotel accommodation"}),(0,s.jsxs)("div",{className:"space-y-3 border border-[#dfe8e2] rounded-xl p-4 bg-[#f9fcf8]",children:[(0,s.jsx)("div",{className:"flex flex-wrap gap-2",children:["none","location","star","locationAndStar"].map(e=>(0,s.jsx)("button",{type:"button",onClick:()=>N(e),className:"px-3 py-2 rounded-full text-sm border ".concat(g===e?"bg-[#2F8D59] text-white border-[#2F8D59]":"bg-white text-[#10231a] border-[#dfe8e2]"),children:r[e]},e))}),"none"!==g&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[("location"===g||"locationAndStar"===g)&&(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)("label",{className:"text-sm font-semibold text-[#10231a]",children:"Location"}),(0,s.jsxs)("select",{value:j,onChange:e=>{y(e.target.value),k(null)},className:"w-full rounded-xl border border-[#dfe8e2] px-3 py-2 text-sm",children:[(0,s.jsx)("option",{value:"",children:"Choose location"}),P.map(e=>(0,s.jsx)("option",{value:e,children:e},e))]})]}),("star"===g||"locationAndStar"===g)&&(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)("label",{className:"text-sm font-semibold text-[#10231a]",children:"Hotel quality"}),(0,s.jsxs)("select",{value:v,onChange:e=>{w(e.target.value),k(null)},className:"w-full rounded-xl border border-[#dfe8e2] px-3 py-2 text-sm",children:[(0,s.jsx)("option",{value:"",children:"Choose rating"}),R.map(e=>(0,s.jsxs)("option",{value:e,children:[e," ★"]},e))]})]})]}),0===_.length?(0,s.jsx)("div",{className:"text-sm text-[#4c5f68] bg-white border border-[#dfe8e2] rounded-lg px-3 py-2",children:"No partner hotels match this selection yet."}):(0,s.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:_.map(e=>{let t=D===e._id;return(0,s.jsx)("button",{type:"button",onClick:()=>k(e._id),className:"w-full text-left border rounded-lg px-4 py-3 transition ".concat(t?"border-[#2F8D59] bg-[#e6f2ea]":"border-[#dfe8e2] bg-white"),children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("p",{className:"font-semibold text-[#10231a]",children:[e.location," ",e.starRating?"\xb7 ".concat(e.starRating,"★"):""]}),(0,s.jsxs)("p",{className:"text-sm text-[#4c5f68]",children:["USD ",e.pricePerNight," / night"]})]}),(0,s.jsx)("span",{className:"h-4 w-4 rounded-full border ".concat(t?"border-[#2F8D59] bg-[#2F8D59]":"border-[#dfe8e2]"),"aria-hidden":!0})]})},e._id)})})]})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3 text-sm",children:[(0,s.jsxs)("div",{className:"rounded-xl border border-[#dfe8e2] bg-[#f5f8f4] px-4 py-3",children:[(0,s.jsx)("p",{className:"text-[#4c5f68]",children:"Price per person"}),(0,s.jsx)("p",{className:"font-semibold text-[#10231a]",children:C?"$".concat(C):"—"})]}),(0,s.jsxs)("div",{className:"rounded-xl border border-[#dfe8e2] bg-[#f5f8f4] px-4 py-3",children:[(0,s.jsx)("p",{className:"text-[#4c5f68]",children:"Duration"}),(0,s.jsxs)("p",{className:"font-semibold text-[#10231a]",children:[S," night",1===S?"":"s"]})]}),(0,s.jsxs)("div",{className:"rounded-xl border-2 border-[#2F8D59] bg-[#e6f2ea] px-4 py-3",children:[(0,s.jsx)("p",{className:"text-[#2F8D59] font-semibold",children:"Total amount"}),(0,s.jsx)("p",{className:"text-lg font-bold text-[#10231a]",children:$?"$".concat($):"—"})]})]}),(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)("label",{className:"text-sm text-[#10231a] font-semibold",children:"Additional Notes"}),(0,s.jsx)("textarea",{name:"notes",rows:3,value:i.notes,onChange:q,className:"w-full rounded-xl border border-[#dfe8e2] px-4 py-3 text-sm text-[#10231a] focus:outline-none focus:border-[#2F8D59] focus:ring-2 focus:ring-[#cfe8d6] resize-none",placeholder:"Share any preferences or health goals"})]}),H,(0,s.jsxs)("div",{className:"flex justify-end gap-2 pt-2",children:[(0,s.jsx)("button",{type:"button",onClick:B,className:"px-4 py-2 rounded-full border border-[#dfe8e2] text-[#10231a] hover:bg-[#f5f8f4] transition",children:"Cancel"}),(0,s.jsx)("button",{type:"submit",disabled:d,className:"px-5 py-2 rounded-full bg-[#2F8D59] text-white text-sm font-semibold hover:bg-[#27784c] transition disabled:opacity-60",children:d?"Sending...":"Book Package"})]})]})]})}):null}},32617:function(e,t,a){a.d(t,{QW:function(){return c},R1:function(){return o},nc:function(){return d},pE:function(){return i},sg:function(){return r}});let s="http://localhost:5000/api".replace(/\/$/,""),n="".concat(s,"/api");async function l(e){let t=await e.json().catch(()=>({}));if(!e.ok){let a=Error((null==t?void 0:t.message)||"Request failed");throw a.status=e.status,a}return t}async function o(e){return l(await fetch("".concat(n).concat(e),{method:"GET",credentials:"include"}))}async function r(e,t){let a="undefined"!=typeof FormData&&t instanceof FormData;return l(await fetch("".concat(n).concat(e),{method:"POST",credentials:"include",headers:a?void 0:{"Content-Type":"application/json"},body:a?t:JSON.stringify(t||{})}))}async function i(e,t){let a="undefined"!=typeof FormData&&t instanceof FormData;return l(await fetch("".concat(n).concat(e),{method:"PUT",credentials:"include",headers:a?void 0:{"Content-Type":"application/json"},body:a?t:JSON.stringify(t||{})}))}async function c(e){return l(await fetch("".concat(n).concat(e),{method:"DELETE",credentials:"include"}))}async function d(e,t){return l(await fetch("".concat(n).concat(e),{method:"PATCH",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(t||{})}))}},27648:function(e,t,a){a.d(t,{default:function(){return n.a}});var s=a(72972),n=a.n(s)}}]);